<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æœåŠ¡å™¨ on G-Hungçš„åšå®¢</title><link>https://blog.yzyy.de/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/</link><description>Recent content in æœåŠ¡å™¨ on G-Hungçš„åšå®¢</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Thu, 17 Jul 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.yzyy.de/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/index.xml" rel="self" type="application/rss+xml"/><item><title>æ–°è´­ä¸€å°8GBçš„VDSä¸æ¬å®¶</title><link>https://blog.yzyy.de/post/%E6%96%B0%E8%B4%AD%E4%B8%80%E5%8F%B08gb%E7%9A%84vds/</link><pubDate>Thu, 17 Jul 2025 00:00:00 +0000</pubDate><guid>https://blog.yzyy.de/post/%E6%96%B0%E8%B4%AD%E4%B8%80%E5%8F%B08gb%E7%9A%84vds/</guid><description>&lt;p>åœ¨7æœˆ8æ—¥ï¼Œäººç§°â€œå°é˜¿é‡Œâ€çš„äº‘æœåŠ¡å™¨æä¾›å•†ã€ŒClawCloudã€å®£å¸ƒä¸‹çº¿æ”¯æŒä¸­å›½ä¼˜åŒ–çº¿è·¯çš„é¦™æ¸¯æœåŠ¡å™¨ã€‚è¿™ä¸ªå…¬å‘Šä¸­è¿˜æåˆ°äº†ä¸‰ä¸ªèµ”å¿æ–¹æ¡ˆï¼Œå…¶ä¸­ä¸¤ä¸ªä¸ºä¸åŒçš„é€€æ¬¾æ–¹æ¡ˆï¼Œè¿™é‡Œé‡ç‚¹å…³æ³¨æ–¹æ¡ˆäºŒï¼šå¯ä»¥å…è´¹è¿ç§»åˆ°æ–°åŠ å¡æˆ–æ—¥æœ¬èŠ‚ç‚¹ï¼Œå¹¶ä¸”**åŸæœ¬æœºå™¨çš„å†…å­˜å®¹é‡è¿˜ä¼šç›´æ¥ç¿»å€ã€‚&lt;/p>
&lt;p>è¿™å°±å¯¼è‡´äº†å¸‚åœºä¸Šå‡ºç°äº†2æ ¸8GBçš„çº¿è·¯è‰¯å¥½çš„æ–°åŠ å¡\æ—¥æœ¬æœºå™¨ï¼Œå¹¶ä¸”ä»·æ ¼ä¸º4$/mï¼Œæœ‰æ²¡æœ‰å¾ˆå¿ƒåŠ¨ï¼Œæˆ‘åæ­£æ˜¯å¿ƒåŠ¨äº†ã€‚&lt;/p>
&lt;p>å›æƒ³èµ·é‚£å¤œè¿œç¨‹å¼€å‘ä½¿ç”¨claude codeå†…å­˜çˆ†ç‚¸ï¼Œç‹¼ç‹ˆé‡å¯ã€‚é‚£å¤œä¸ºäº†å®‰è£…OpenWebUIï¼Œä¸€å£æ°”å¼€äº†2gçš„swapã€‚ç•ç•ç¼©ç¼©ä¸æ•¢ä½¿ç”¨åŠ¨æ€åšå®¢ã€ä¸æ•¢ä½¿ç”¨1panelç­‰è¿ç»´é¢æ¿ã€‚æ€•äº†çœŸæ€•äº†ï¼ŒğŸ˜­ç‹¼ç‹ˆçš„æˆ‘å«æ³ªæº¢ä»·ä¸€ç™¾å—æ”¶ä¸‹ä¸€å°æœºå™¨ï¼Œåªå¸Œæœ›èƒ½ç”¨çš„é•¿ä¹…å§ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹è®°å½•ä¸€ä¸‹æˆ‘æ‹¿åˆ°ä¸€å°æ–°æœºå™¨ä¼šåšä»€ä¹ˆä»¥åŠè¿ç§»è¿‡ç¨‹ã€‚&lt;/p>
&lt;hr>
&lt;h2 class="heading" id="å®‰å…¨">
 å®‰å…¨
 &lt;a class="anchor" href="#%e5%ae%89%e5%85%a8">#&lt;/a>
&lt;/h2>
&lt;p>æœ€é‡è¦çš„å½“ç„¶æ˜¯å®‰å…¨ï¼Œä¹‹å‰å·²ç»ç»™å‡ºäº†æœåŠ¡å™¨çš„å®‰å…¨è®ºï¼Œè¯·çœ‹&lt;a href="https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/vps%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD/">VPSåŸºç¡€å®‰å…¨é…ç½®å®è·µæŒ‡å—&lt;/a>ã€‚&lt;/p>
&lt;h2 class="heading" id="å®‰è£…docker">
 å®‰è£…docker
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85docker">#&lt;/a>
&lt;/h2>
&lt;p>å› ä¸ºå¤šæ•°æœåŠ¡æ˜¯è¿è¡Œåœ¨dockerä¸Šçš„ï¼Œå®‰è£…docker &amp;amp; docker composeæ˜¯å¿…ä¸å¯å°‘çš„ã€‚&lt;/p>
&lt;h2 class="heading" id="sslè¯ä¹¦">
 SSLè¯ä¹¦
 &lt;a class="anchor" href="#ssl%e8%af%81%e4%b9%a6">#&lt;/a>
&lt;/h2>
&lt;p>ä¸æ˜¯ç®€å•åœ°è¿ç§»å·²æœ‰è¯ä¹¦å°±è¡Œäº†ï¼Œè¿˜è¦è¿ç§»é…ç½®å¥½çš„è‡ªåŠ¨ç»­ç­¾æœåŠ¡ï¼Œç»è¿‡æŸ¥çœ‹åœ¨ä¸€å°æœºå™¨ä¸Šæœ‰å››ä¸ªåŸŸåçš„è‡ªåŠ¨ç»­ç­¾æœåŠ¡ï¼Œä½†æ˜¯æˆ‘å‡†å¤‡ç˜¦èº«ä¸€ä¸‹ï¼Œæœ‰äº›åŸŸåå¿«åˆ°æœŸäº†ã€‚












&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="" src="https://webp.050612.xyz/2025/07/certificates.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h3 class="heading" id="è‡ªåŠ¨ç»­ç­¾æ”¹è¿›åçš„æ–¹æ¡ˆ">
 è‡ªåŠ¨ç»­ç­¾æ”¹è¿›åçš„æ–¹æ¡ˆ
 &lt;a class="anchor" href="#%e8%87%aa%e5%8a%a8%e7%bb%ad%e7%ad%be%e6%94%b9%e8%bf%9b%e5%90%8e%e7%9a%84%e6%96%b9%e6%a1%88">#&lt;/a>
&lt;/h3>
&lt;p>å‘ç°ä¹‹å‰çš„å¤šä¸ªåŸŸåçš„è‡ªåŠ¨ç»­ç­¾ç®¡ç†ååˆ†ç¹çï¼Œä¸AIäº¤æµåè·å¾—äº†ä¸€ä¸ªæ›´ä¸ºç®€æ´çš„å¯è¡Œçš„æ–¹æ¡ˆï¼Œç®€åŒ–äº†æ“ä½œä¸é…ç½®ã€‚&lt;/p>
&lt;h4 class="heading" id="cloudflare-api">
 Cloudflare API
 &lt;a class="anchor" href="#cloudflare-api">#&lt;/a>
&lt;/h4>
&lt;p>ä½¿ç”¨ Cloudflare DNS æ¨¡å¼éœ€è¦å‡†å¤‡:&lt;/p>
&lt;ul>
&lt;li>Account ID&lt;/li>
&lt;li>API Token&lt;/li>
&lt;/ul>
&lt;h5 class="heading" id="è·å–-account-id">
 è·å– Account ID
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-account-id">#&lt;/a>
&lt;/h5>
&lt;p>è¿™ä¸¤ç§ ID ç›´æ¥åœ¨ Overview é¡µå°±èƒ½æ‰¾åˆ°ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="cloudflare_account_id" src="https://webp.050612.xyz/2025/07/cloudflare_account_id.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h5 class="heading" id="è·å–-api-token">
 è·å– API Token
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-api-token">#&lt;/a>
&lt;/h5>
&lt;p>Overview é¡µç‚¹å‡» &lt;code>è·å–æ‚¨çš„ API ä»¤ç‰Œ&lt;/code> è¿›å…¥ API Tokens é¡µã€‚&lt;/p>
&lt;p>ç‚¹å‡» API Tokens é¡¹æ—è¾¹ &lt;code>åˆ›å»ºä»¤ç‰Œ&lt;/code> æŒ‰é’®ï¼Œæ¥ç€é€‰æ‹© &lt;code>ç¼–è¾‘åŒºåŸŸ DNS&lt;/code> çš„æ¨¡æ¿ï¼Œç‚¹å‡» &lt;code>ä½¿ç”¨æ¨¡æ¿&lt;/code>ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/e15d8a0a1de821faab5355e610b581016975b974_2_690x265.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/42f87595d27a6fb3ed1fe329934517f5416920c6_2_690x210.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>&lt;code>åŒºåŸŸèµ„æº&lt;/code> é‡Œé€‰æ‹©éœ€è¦ç­¾å‘çš„åŸŸåï¼Œå¤šä¸ªåŸŸåé€‰æ‹©å¤šä¸ªã€‚ä¸å»ºè®®é€‰æ‹©å…¨éƒ¨çš„åŸŸåï¼Œ**æœ€å°æƒé™åŸåˆ™ã€‚&lt;/p>
&lt;p>åœ¨ &lt;code>å®¢æˆ·ç«¯ IP åœ°å€ç­›é€‰&lt;/code> é‡Œå»ºè®®å†™ä¸‹ acme.sh æ‰€åœ¨çš„ä¸»æœºåšä¸ºç™½åå•ï¼Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœæœåŠ¡å™¨æœ‰ ipv6 åœ°å€ï¼Œåˆ™ä¹Ÿéœ€è¦æ·»åŠ ï¼Œå› ä¸ºæœ‰å¯èƒ½ä¼š ipv6 ä¼˜å…ˆè®¿é—®ã€‚&lt;/p>
&lt;p>å‡» &lt;code>ç»§ç»­ä»¥æ˜¾ç¤ºæ‘˜è¦&lt;/code> , ç¡®è®¤æ²¡é—®é¢˜åæœ€åç‚¹å‡» &lt;code>åˆ›å»ºä»¤ç‰Œ&lt;/code>ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/e88966d6049c27c31c632f9471ec1b79be287b59_2_510x499.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>æ­¤æ—¶å°±ä¼šå‡ºç°ä¸€ä¸ª Token,ï¼Œå³ CF_Tokenï¼Œæ‹·è´å¤‡ç”¨ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/ca6093ea6bf83325809ea6179d4239ae2c9818cc_2_690x404.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h5 class="heading" id="æ³¨æ„">
 æ³¨æ„
 &lt;a class="anchor" href="#%e6%b3%a8%e6%84%8f">#&lt;/a>
&lt;/h5>
&lt;ul>
&lt;li>&lt;strong>æ³¨æ„æ–°å¢åŸŸåæ—¶ï¼Œéœ€è¦æ›´æ”¹API Tokenæ‰€åŒ…å«çš„åŸŸå&lt;/strong>&lt;/li>
&lt;li>&lt;strong>æ³¨æ„æœ‰å¤šå°æœºå™¨æ—¶ï¼Œéœ€è¦æ–°å¢æœºå™¨çš„IPåˆ°ç™½åå•&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="update_cf_api_token" src="https://webp.050612.xyz/2025/02/update_cf_api_token.png" >
 &lt;/div>

 
&lt;/figure>













&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="cf-api-token-ip" src="https://webp.050612.xyz/2025/02/cf-api-token-ip.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h4 class="heading" id="ä¸€ä¸ªå®Œæ•´çš„æ¼”ç¤º">
 ä¸€ä¸ªå®Œæ•´çš„æ¼”ç¤º
 &lt;a class="anchor" href="#%e4%b8%80%e4%b8%aa%e5%ae%8c%e6%95%b4%e7%9a%84%e6%bc%94%e7%a4%ba">#&lt;/a>
&lt;/h4>
&lt;p>è·å–åˆ°äº†ä»¥ä¸Šä¸¤ä¸ªtokenå³å¯å¼€å§‹æ“ä½œã€‚&lt;/p>
&lt;p>ä¸ºäº†ä½¿æ•´ä¸ªæµç¨‹æ›´åŠ æ¸…æ™°ï¼ˆ&lt;del>æ–¹ä¾¿è‡ªå·±æ“ä½œ&lt;/del>ï¼‰ï¼Œè¿™é‡Œè´´ä¸€ä¸ªè‡ªå·±å¹³æ—¶ä½¿ç”¨ acme.sh ç”³è¯·è¯ä¹¦çš„å®Œæ•´æµç¨‹ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”³è¯·æ–¹å¼ï¼šDNS è®¤è¯ï¼ˆä½¿ç”¨ Cloudflare APIï¼‰&lt;/li>
&lt;li>ç”³è¯·è¯ä¹¦ CAï¼šLetâ€™s Encrypt&lt;/li>
&lt;li>ç”³è¯·è¯ä¹¦ç±»å‹ï¼šRSA + ECC ä¸¤ä¸ªé€šé…ç¬¦è¯ä¹¦&lt;/li>
&lt;/ul>
&lt;p>åç»­ç”³è¯·è¯ä¹¦çš„å‘½ä»¤ï¼Œéƒ½æ˜¯åœ¨ root ç”¨æˆ·ä¸‹æ‰§è¡Œçš„ï¼Œè¯·å…ˆä½¿ç”¨ &lt;code>su&lt;/code> åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è¿›å…¥rootç”¨æˆ·&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>su
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… acme.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl https://get.acme.sh | sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># åˆ·æ–° shell å˜é‡é…ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">source&lt;/span> ~/.bashrc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å¯¼å…¥ Cloudflare API Token&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Token&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Account_ID&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è®¾ç½®é»˜è®¤ CA ä¸º Let&amp;#39;s Encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --set-default-ca --server letsencrypt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ RSA è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue --dns dns_cf -d xxx.xyz -d *.xxx.xyz --keylength 2048
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… RSA è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --install-cert -d domain.tld &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ ECC è¯ä¹¦ï¼Œè‹¥ä¸éœ€è¦ï¼Œè·³è¿‡å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue --dns dns_cf -d domain.tld -d *.domain.tld --keylength ec-256
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… ECC è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --install-cert -d domain.tld --ecc &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/ecc_domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/ecc_domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/ecc_domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è‡³æ­¤è¯ä¹¦å®‰è£…å®Œæ¯•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ä¸‹é¢æ˜¯åŒä¸€å°ä¸»æœºç”³è¯·ç¬¬äºŒä¸ªåŸŸåè¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">###############################ç¬¬äºŒä¸ªåŸŸå#####################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ RSA è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue --dns dns_cf -d xxx.xyz -d *.xxx.xyz --keylength 2048
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… RSA è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--install-cert -d domain.tld &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ ECC è¯ä¹¦ï¼Œè‹¥ä¸éœ€è¦ï¼Œè·³è¿‡å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 --issue --dns dns_cf -d domain.tld -d *.domain.tld --keylength ec-256
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… ECC è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--install-cert -d domain.tld --ecc &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/ecc_domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/ecc_domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/ecc_domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ£€æŸ¥cronå®šæ—¶ä»»åŠ¡æ˜¯å¦å·²ç»æˆåŠŸåˆ›å»º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>crontab -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„åŸŸåæˆ–è€…æ–°å¢åŸŸåï¼Œ
åªéœ€è¦ï¼š&lt;/p>
&lt;ol>
&lt;li>åœ¨Cloudflareçš„ã€ŒAPI Tokenã€ç®¡ç†ä¸­ï¼Œæ–°å¢API Tokenæ‰€åŒ…å«çš„åŸŸå&lt;/li>
&lt;li>ç­¾å‘æ–°åŸŸåçš„è¯ä¹¦å¹¶å®‰è£…åˆ°æŒ‡å®šä½ç½®&lt;/li>
&lt;/ol>
&lt;p>acme.shä¼šæ£€æŸ¥æ‰€ç®¡ç†çš„æ‰€æœ‰åŸŸåçš„è¯ä¹¦çš„åˆ°æœŸæ—¶é—´ï¼Œå¦‚æœéœ€è¦ç»­ç­¾ï¼Œåˆ™ä¼šæ‰§è¡Œç»­ç­¾æ“ä½œå¹¶å®‰è£…å¯¼è‡´è®¢ä½ç½®ï¼Œå®ç°è¯ä¹¦çš„è‡ªåŠ¨ç»­ç­¾ã€‚ä¸€åŠ³æ°¸é€¸çš„æ“ä½œã€‚&lt;/p>
&lt;h2 class="heading" id="è¿ç§»æœåŠ¡">
 è¿ç§»æœåŠ¡
 &lt;a class="anchor" href="#%e8%bf%81%e7%a7%bb%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;p>åˆ°äº†æœ€å¤æ‚çš„ä¸€ä¸ªç¯èŠ‚äº†ï¼Œå³ä½¿è¿è¡Œåœ¨dockerçš„æœåŠ¡ï¼Œæ¯ä¸ªä¹Ÿè¦è¿ç§»volumesã€nginxé…ç½®ï¼Œå¼€å¹²ï¼ğŸ’ªæ­£å¥½å‡‘è¿™ä¸ªæœºä¼šç»Ÿè®¡ä¸€ä¸‹æˆ‘è¿è¡Œäº†å“ªäº›æœåŠ¡ã€‚&lt;/p>
&lt;h3 class="heading" id="openwebui--newapi">
 OpenWebUI + NewAPI
 &lt;a class="anchor" href="#openwebui--newapi">#&lt;/a>
&lt;/h3>
&lt;ol>
&lt;li>æ‰“åŒ…æŒä¹…åŒ–æ•°æ®ï¼Œå…¶ä¸­NewAPIçš„MySQLä½¿ç”¨äº†Dockerçš„å‘½åå·&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">######## æ‰“åŒ…OpenWebUIå’ŒNewAPIçš„æŒä¹…åŒ–æ•°æ®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar -czvf data.tar.gz ./openwebui ./newapi
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">######## æ‰“åŒ…newapi MySQLæ•°æ®å· ###########&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># æŸ¥æ‰¾å·çš„ç‰©ç†è·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker volume inspect [é¡¹ç›®å]_mysql_data
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># åœ¨è¾“å‡ºä¸­æ‰¾åˆ° &amp;#34;Mountpoint&amp;#34;: &amp;#34;/var/lib/docker/volumes/[é¡¹ç›®å]_mysql_data/_data&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo tar -czvf ~/mysql_volume.tar.gz /var/lib/docker/volumes/[é¡¹ç›®å]_mysql_data/_data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>ä½¿ç”¨SFTPåŠŸèƒ½ä¼ è¾“åˆ°æ–°æœºå™¨&lt;/li>
&lt;li>åœ¨æ–°æœºå™¨ä¸Šè§£å‹&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-BASH" data-lang="BASH">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">######## è§£å‹OpenWebUIå’ŒNewAPIçš„æŒä¹…åŒ–æ•°æ®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo tar -xzvf data.tar.gz -C ./
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">######## è§£å‹newapi MySQLæ•°æ®å· ###########&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># æ‰‹åŠ¨åˆ›å»ºç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo mkdir -p /var/lib/docker/volumes/[é¡¹ç›®å]_mysql_data/_data
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è§£å‹æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo tar -xzvf ~/mysql_volume.tar.gz -C /var/lib/docker/volumes/[é¡¹ç›®å]_mysql_data/_data
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ä¿®å¤æ–‡ä»¶æƒé™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo chown -R 999:999 /var/lib/docker/volumes/[é¡¹ç›®å]_mysql_data/_data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>é…ç½®nginx&lt;/li>
&lt;/ol>
&lt;p>ç›´æ¥æŠŠæ—§æœºå™¨ä¸Šçš„nginxæ‰“åŒ…ä¸Šä¼ åˆ°æ–°æœºä¸Šï¼Œæ“ä½œåªéœ€è¦å»ºç«‹site-availableä¸site-enableçš„è½¯è¿æ¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ln -s /etc/nginx/sites-available/api.vtofun.me /etc/nginx/sites-enabled/api.vtofun.me
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ç»·ä¸ä½äº†ï¼Œç¬¬ä¸€æ¬¡æ¬å®¶ååˆ†ä¹ƒè‡³ä¸‡åˆ†ä¸é¡ºåˆ©ï¼Œä»ä¸ƒç‚¹æ¬åˆ°åä¸€ç‚¹åŠè¿˜æ²¡æ¬å®Œã€‚æ¬å®¶å¤ªç´¯äº†ğŸ˜­&lt;/p>&lt;/blockquote>
&lt;h3 class="heading" id="openlist">
 OpenList
 &lt;a class="anchor" href="#openlist">#&lt;/a>
&lt;/h3>
&lt;p>æƒ³åˆ°å‰æ®µæ—¶é—´çš„alistçš„æš´é›·å•†ä¸šåŒ–ï¼Œæˆ‘è¿˜æ˜¯æŠŠé•œåƒæ¢æˆOpenListå§ã€‚&lt;/p>
&lt;ol>
&lt;li>dockeré•œåƒå˜æ›´&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>version: &lt;span style="color:#666;font-style:italic">&amp;#39;3.3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>services:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> alist:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> image: &lt;span style="color:#666;font-style:italic">&amp;#39;openlistteam/openlist:latest&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> container_name: alist
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> volumes:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#666;font-style:italic">&amp;#39;./data:/opt/alist/data&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ports:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#666;font-style:italic">&amp;#39;127.0.0.1:1259:5244&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> environment:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - PUID=0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - PGID=0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - UMASK=022
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> restart: unless-stopped
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>é…ç½®nginx&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ln -s /etc/nginx/sites-available/api.vtofun.me /etc/nginx/sites-enabled/api.vtofun.me
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>æ³¨æ„æ‰“å¼€adminç”¨æˆ·çš„webdavçš„è¯»æƒé™ã€‚&lt;/li>
&lt;/ol>
&lt;h3 class="heading" id="sub-store">
 sub-store
 &lt;a class="anchor" href="#sub-store">#&lt;/a>
&lt;/h3>
&lt;p>å¾ˆå¥½ç”¨çš„ä»£ç†é…ç½®ç®¡ç†è½¯ä»¶&lt;/p>
&lt;ol>
&lt;li>nginx&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ln -s /etc/nginx/sites-available/substore /etc/nginx/sites-enabled/substore
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl restart nginx.service 
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="pdfmathtranslate">
 PDFMathTranslate
 &lt;a class="anchor" href="#pdfmathtranslate">#&lt;/a>
&lt;/h3>
&lt;p>ä¸€ä¸ªåŸºäº AI å®Œæ•´ä¿ç•™æ’ç‰ˆçš„ PDF æ–‡æ¡£å…¨æ–‡åŒè¯­ç¿»è¯‘ï¼Œæ”¯æŒ Google/DeepL/Ollama/OpenAI ç­‰æœåŠ¡ã€‚&lt;/p></description></item><item><title>åŸŸåç®¡ç†ï¼šCloudflare DNSæ‰˜ç®¡ä¸SSLè¯ä¹¦é…ç½®</title><link>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%9F%9F%E5%90%8D%E7%9B%B8%E5%85%B3/</link><pubDate>Wed, 08 May 2024 00:00:00 +0000</pubDate><guid>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%9F%9F%E5%90%8D%E7%9B%B8%E5%85%B3/</guid><description>&lt;h1 class="heading" id="åŸŸåç›¸å…³">
 åŸŸåç›¸å…³
 &lt;a class="anchor" href="#%e5%9f%9f%e5%90%8d%e7%9b%b8%e5%85%b3">#&lt;/a>
&lt;/h1>
&lt;p>æœ¬ç¯‡è®°å½•ä¸€ä¸‹åŸŸåç›¸å…³çš„æ“ä½œå§ï¼ŒåŒ…æ‹¬åˆ°cfæ‰˜ç®¡ï¼Œç”³è¯·ä¸å®‰è£…SSLè¯ä¹¦ç­‰ã€‚&lt;/p>
&lt;h2 class="heading" id="dnsè§£æå’Œå°†åŸŸåæ‰˜ç®¡åˆ°cloudflare">
 DNSè§£æå’Œå°†åŸŸåæ‰˜ç®¡åˆ°cloudflare
 &lt;a class="anchor" href="#dns%e8%a7%a3%e6%9e%90%e5%92%8c%e5%b0%86%e5%9f%9f%e5%90%8d%e6%89%98%e7%ae%a1%e5%88%b0cloudflare">#&lt;/a>
&lt;/h2>
&lt;p>æ„Ÿè°¢&lt;a href="https://sarakale.top/blog/posts/3a730d01/#%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C">Namesilo/CloudflareåŸŸåæ³¨å†Œå’Œè§£æè®¾ç½®æ•™ç¨‹ | SaraKale&amp;rsquo;s blog&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>åˆ°Â &lt;a href="https://www.cloudflare.com/">Cloudflare&lt;/a>Â æ·»åŠ ä½ çš„ç«™ç‚¹ï¼Œé€‰æ‹© Free å…è´¹è®¡åˆ’ã€‚











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113153620" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113153620.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨ä¸‹ä¸€é¡µä¸Šï¼Œæ‚¨éœ€è¦é€‰æ‹©é¦–é€‰çš„ CDN è®¡åˆ’ã€‚é€‰æ‹© Free è®¡åˆ’ã€‚å•å‡»å…¶å›¾æ ‡å’Œ&lt;strong>ç¡®è®¤è®¡åˆ’&lt;/strong>æŒ‰é’®ç»§ç»­ï¼š











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113153644" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113153644.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœä¹‹å‰å·²ç»åšè¿‡è§£æå°±å¯ä»¥çœ‹åˆ°ç°æœ‰çš„DNSè®°å½•ã€‚











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113153828" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113153828.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿™é‡Œå…ˆä¸ç”¨ç®¡ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ã€‚











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113153859" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113153859.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯ä»¥çœ‹åˆ°ç»™äº†ä¸¤ä¸ªNSæœåŠ¡å™¨ï¼Œå›åˆ°åŸŸåæä¾›å•†åå°æ›´æ”¹NSæœåŠ¡å™¨ã€‚











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113153945" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113153945.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>NameCheapæ›´æ”¹nsæœåŠ¡å™¨å‚è€ƒå®˜æ–¹æ•™ç¨‹&lt;a href="https://www.namecheap.com/support/knowledgebase/article.aspx/9607/2210/how-to-set-up-dns-records-for-your-domain-in-a-cloudflare-account/">Title Unavailable | Site Unreachable&lt;/a>ï¼Œå…¶ä»–åŸŸåæœåŠ¡å•†å¤§åŒå°å¼‚ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 class="heading" id="ç”³è¯·tlssslè¯ä¹¦">
 ç”³è¯·TLS\SSLè¯ä¹¦
 &lt;a class="anchor" href="#%e7%94%b3%e8%af%b7tlsssl%e8%af%81%e4%b9%a6">#&lt;/a>
&lt;/h2>
&lt;p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œç›®å‰é€‰æ‹©cloudflareå¼€å¯ä»£ç†çš„æ¨¡å¼&lt;/p>
&lt;ul>
&lt;li>è‡ªåŠ¨ç»­ç­¾ï¼š&lt;/li>
&lt;li>ä½¿ç”¨cloudflareçš„æœåŠ¡ï¼Œå¼€å¯å°é»„äº‘ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸€ç§æ³›åŸŸåè¯ä¹¦ï¼Œåªèƒ½å½“åšæºç«™å’Œcloudflareæ¡æ‰‹çš„å‡­è¯ï¼Œå…¶ä»–çš„ä¸è®¤ã€‚&lt;/li>
&lt;/ul>
&lt;h3 class="heading" id="cloudflareçš„æœåŠ¡">
 cloudflareçš„æœåŠ¡
 &lt;a class="anchor" href="#cloudflare%e7%9a%84%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h3>
&lt;p>ä¸‹é¢é‡‡ç”¨cloudflareçš„æœåŠ¡ï¼Œä¹Ÿæ˜¯ä¸€ä»½cloudflareçš„åˆæ­¥æ¢ç´¢çš„è®°å½•&lt;/p>
&lt;h4 class="heading" id="dnsç®¡ç†">
 DNSç®¡ç†
 &lt;a class="anchor" href="#dns%e7%ae%a1%e7%90%86">#&lt;/a>
&lt;/h4>
&lt;p>å¯ä»¥åœ¨DNSç•Œé¢ç®¡ç†DNSè§£æï¼Œä»¥åŠç®¡ç†æ˜¯å¦å¼€å¯å°é»„äº‘ä»£ç†











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="e%2020250113163808" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113163808.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h4 class="heading" id="ssltlsè¯ä¹¦">
 SSL\TLSè¯ä¹¦
 &lt;a class="anchor" href="#ssltls%e8%af%81%e4%b9%a6">#&lt;/a>
&lt;/h4>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113164004" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113164004.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;ul>
&lt;li>çµæ´»ï¼šwebæµè§ˆå™¨å’Œcloudflareä¹‹é—´é‡‡ç”¨443HTTPSï¼Œcloudflareå’Œcloudflareä¹‹é—´é‡‡ç”¨80HTTP&lt;/li>
&lt;li>å®Œå…¨ï¼šä½¿ç”¨å…¶ä»–æœªå…¬å¼€è®¤è¯çš„SSLè¯ä¹¦æ—¶é‡‡ç”¨ï¼ŒæºæœåŠ¡å™¨å¿…é¡»é…ç½® SSL è¯ä¹¦ï¼Œä½† CloudflareÂ &lt;strong>ä¸éªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§&lt;/strong>ï¼ˆä¾‹å¦‚ï¼Œå¯ä»¥æ˜¯è‡ªç­¾åè¯ä¹¦æˆ–è¿‡æœŸè¯ä¹¦ï¼‰ã€‚&lt;/li>
&lt;li>å®Œå…¨ï¼ˆä¸¥æ ¼ï¼‰ï¼šå®¢æˆ·ç«¯åˆ° Cloudflareï¼šHTTPSï¼ˆä½¿ç”¨ Cloudflare Universal SSL è¯ä¹¦ï¼‰ã€‚ Cloudflare åˆ°æºæœåŠ¡å™¨ï¼š&lt;strong>HTTPSï¼ˆåŠ å¯†ï¼‰&lt;/strong>ã€‚æºæœåŠ¡å™¨å¿…é¡»é…ç½®æœ‰æ•ˆçš„ SSL è¯ä¹¦ï¼Œè¯¥è¯ä¹¦å¿…é¡»ç”±&lt;strong>å—ä¿¡ä»»çš„ CA æœºæ„ç­¾å‘&lt;/strong>æˆ–ä¸ºÂ &lt;strong>Cloudflare Origin CA è¯ä¹¦&lt;/strong>ï¼Œå¹¶ä¸”è¯ä¹¦ä¸­çš„åŸŸåå¿…é¡»ä¸è¯·æ±‚çš„åŸŸååŒ¹é…ã€‚Cloudflare ä¼šéªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬æœ‰æ•ˆæœŸã€é¢å‘æœºæ„å’ŒåŸŸåã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥åœ¨æºæœåŠ¡å™¨é¡µé¢ç”³è¯·Â &lt;strong>Cloudflare Origin CA è¯ä¹¦&lt;/strong>ï¼Œå¹¶å°†è¯¥è¯ä¹¦æ”¾åˆ°æœåŠ¡å™¨ä¸Šã€‚æºè¯ä¹¦ä»…å¯¹Cloudflareä¸æºæœåŠ¡å™¨ä¹‹é—´çš„åŠ å¯†æœ‰æ•ˆã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113164800" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113164800.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h4 class="heading" id="under-attack">
 Under Attack
 &lt;a class="anchor" href="#under-attack">#&lt;/a>
&lt;/h4>
&lt;ul>
&lt;li>å¯ä»¥åœ¨å®‰å…¨æ€§-è®¾ç½®é‡Œæ‰“å¼€Under Attackæ¨¡å¼ï¼Œå¼ºåˆ¶å¼€å¯éªŒè¯ã€‚











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="Pasted%20image%2020250113165205" src="https://webp.050612.xyz/2025/02/Pasted%20image%2020250113165205.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 class="heading" id="ä½¿ç”¨-acmesh-dns-éªŒè¯çš„æ–¹å¼ç­¾å‘-letsencrypt-è¯ä¹¦">
 ä½¿ç”¨ acme.sh DNS éªŒè¯çš„æ–¹å¼ç­¾å‘ Let&amp;rsquo;sEncrypt è¯ä¹¦
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8-acmesh-dns-%e9%aa%8c%e8%af%81%e7%9a%84%e6%96%b9%e5%bc%8f%e7%ad%be%e5%8f%91-letsencrypt-%e8%af%81%e4%b9%a6">#&lt;/a>
&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://blog.uuphy.com/posts/%E9%85%8D%E7%BD%AE-acme.sh-%E5%85%8D%E8%B4%B9%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%8F%91%E6%B3%9B%E5%9F%9F%E5%90%8D%E8%AF%81%E4%B9%A6/">ä½¿ç”¨ acme.sh DNS éªŒè¯çš„æ–¹å¼ç­¾å‘ Let&amp;rsquo;sEncrypt è¯ä¹¦&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://acme.sh/">acme.sh&lt;/a> æ˜¯ä¸€ä¸ªç”¨æ¥è‡ªåŠ¨è·å–å’Œç®¡ç† SSL/TLS è¯ä¹¦çš„å¼€æºè„šæœ¬ï¼Œå¯ä»¥ä» Letâ€™s Encrypt ç­‰å¤šä¸ª CA è·å–å…è´¹çš„è¯ä¹¦ã€‚ç»“åˆä½¿ç”¨ Cloudflare DNS éªŒè¯çš„æ¨¡å¼ç”³è¯·æ³›åŸŸåè¯ä¹¦ï¼Œå¹¶è‡ªåŠ¨ç»­ç­¾ã€‚&lt;/p>
&lt;hr>
&lt;p>2025-07-17æ›´æ–°&lt;/p>
&lt;p>æ–¹æ¡ˆæœ‰æ”¹è¿›ï¼Œè¯·çœ‹&lt;a href="https://blog.yzyy.de/post/%E6%96%B0%E8%B4%AD%E4%B8%80%E5%8F%B08gb%E7%9A%84vds/#è‡ªåŠ¨ç»­ç­¾çš„æ–¹æ¡ˆæ”¹è¿›">æ–°è´­ä¸€å°8GBçš„VDS&lt;/a>ã€‚
ä¸»è¦ä¼˜åŒ–äº†ä¸€å°vpså¤šä¸ªåŸŸåçš„é…ç½®æ–¹å¼ï¼Œå¦‚æœæ˜¯å•ä¸ªåŸŸåï¼Œä»¥ä¸‹æ–¹æ¡ˆç›¸åŒã€‚&lt;/p>
&lt;h4 class="heading" id="cloudflare-api">
 Cloudflare API
 &lt;a class="anchor" href="#cloudflare-api">#&lt;/a>
&lt;/h4>
&lt;p>ä½¿ç”¨ Cloudflare DNS æ¨¡å¼éœ€è¦å‡†å¤‡:&lt;/p>
&lt;ul>
&lt;li>Zone ID&lt;/li>
&lt;li>Account ID&lt;/li>
&lt;li>API Token&lt;/li>
&lt;/ul>
&lt;h5 class="heading" id="è·å–-zone-id-account-id">
 è·å– Zone ID, Account ID
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-zone-id-account-id">#&lt;/a>
&lt;/h5>
&lt;p>è¿™ä¸¤ç§ ID ç›´æ¥åœ¨ Overview é¡µå°±èƒ½æ‰¾åˆ°ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/2edb816d28456e59ad4da2b02c3ff69450847554_2_690x370.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h5 class="heading" id="è·å–-api-token">
 è·å– API Token
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-api-token">#&lt;/a>
&lt;/h5>
&lt;p>Overview é¡µç‚¹å‡» &lt;code>è·å–æ‚¨çš„ API ä»¤ç‰Œ&lt;/code> è¿›å…¥ API Tokens é¡µã€‚&lt;/p>
&lt;p>ç‚¹å‡» API Tokens é¡¹æ—è¾¹ &lt;code>åˆ›å»ºä»¤ç‰Œ&lt;/code> æŒ‰é’®ï¼Œæ¥ç€é€‰æ‹© &lt;code>ç¼–è¾‘åŒºåŸŸ DNS&lt;/code> çš„æ¨¡æ¿ï¼Œç‚¹å‡» &lt;code>ä½¿ç”¨æ¨¡æ¿&lt;/code>ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/e15d8a0a1de821faab5355e610b581016975b974_2_690x265.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/42f87595d27a6fb3ed1fe329934517f5416920c6_2_690x210.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>&lt;code>åŒºåŸŸèµ„æº&lt;/code> é‡Œé€‰æ‹©éœ€è¦ç­¾å‘çš„åŸŸåï¼Œ&lt;/p>
&lt;p>åœ¨ &lt;code>å®¢æˆ·ç«¯ IP åœ°å€ç­›é€‰&lt;/code> é‡Œå»ºè®®å†™ä¸‹ acme.sh æ‰€åœ¨çš„ä¸»æœºåšä¸ºç™½åå•ï¼Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœæœåŠ¡å™¨æœ‰ ipv6 åœ°å€ï¼Œåˆ™ä¹Ÿéœ€è¦æ·»åŠ ï¼Œå› ä¸ºæœ‰å¯èƒ½ä¼š ipv6 ä¼˜å…ˆè®¿é—®ã€‚&lt;/p>
&lt;p>å‡» &lt;code>ç»§ç»­ä»¥æ˜¾ç¤ºæ‘˜è¦&lt;/code> , ç¡®è®¤æ²¡é—®é¢˜åæœ€åç‚¹å‡» &lt;code>åˆ›å»ºä»¤ç‰Œ&lt;/code>ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/e88966d6049c27c31c632f9471ec1b79be287b59_2_510x499.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;p>æ­¤æ—¶å°±ä¼šå‡ºç°ä¸€ä¸ª Token,ï¼Œå³ CF_Tokenï¼Œæ‹·è´å¤‡ç”¨ã€‚&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="image" src="https://webp.050612.xyz/2025/02/ca6093ea6bf83325809ea6179d4239ae2c9818cc_2_690x404.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h5 class="heading" id="æ³¨æ„">
 æ³¨æ„
 &lt;a class="anchor" href="#%e6%b3%a8%e6%84%8f">#&lt;/a>
&lt;/h5>
&lt;ul>
&lt;li>&lt;strong>æ³¨æ„æ–°å¢åŸŸåæ—¶ï¼Œéœ€è¦æ›´æ”¹API Tokenæ‰€åŒ…å«çš„åŸŸå&lt;/strong>&lt;/li>
&lt;li>&lt;strong>æ³¨æ„æœ‰å¤šå°æœºå™¨æ—¶ï¼Œéœ€è¦æ–°å¢æœºå™¨çš„IPåˆ°ç™½åå•&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="update_cf_api_token" src="https://webp.050612.xyz/2025/02/update_cf_api_token.png" >
 &lt;/div>

 
&lt;/figure>













&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="cf-api-token-ip" src="https://webp.050612.xyz/2025/02/cf-api-token-ip.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h4 class="heading" id="ä¸€ä¸ªå®Œæ•´çš„æ¼”ç¤º">
 ä¸€ä¸ªå®Œæ•´çš„æ¼”ç¤º
 &lt;a class="anchor" href="#%e4%b8%80%e4%b8%aa%e5%ae%8c%e6%95%b4%e7%9a%84%e6%bc%94%e7%a4%ba">#&lt;/a>
&lt;/h4>
&lt;p>æ„Ÿè°¢ï¼š&lt;a href="https://atpx.com/blog/auto-update-ssl-with-acme/">ä½¿ç”¨ acme.sh è‡ªåŠ¨ç­¾å‘å’Œæ›´æ–°è¯ä¹¦ - atpX&lt;/a>&lt;/p>
&lt;p>ä¸ºäº†ä½¿æ•´ä¸ªæµç¨‹æ›´åŠ æ¸…æ™°ï¼ˆ&lt;del>æ–¹ä¾¿è‡ªå·±æ“ä½œ&lt;/del>ï¼‰ï¼Œè¿™é‡Œè´´ä¸€ä¸ªè‡ªå·±å¹³æ—¶ä½¿ç”¨ acme.sh ç”³è¯·è¯ä¹¦çš„å®Œæ•´æµç¨‹ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”³è¯·æ–¹å¼ï¼šDNS è®¤è¯ï¼ˆä½¿ç”¨ Cloudflare APIï¼‰&lt;/li>
&lt;li>ç”³è¯·è¯ä¹¦ CAï¼šLetâ€™s Encrypt&lt;/li>
&lt;li>ç”³è¯·è¯ä¹¦ç±»å‹ï¼šRSA + ECC ä¸¤ä¸ªé€šé…ç¬¦è¯ä¹¦&lt;/li>
&lt;li>**åŒä¸€å°ä¸»æœºå¤šä¸ªåŸŸåçš„æƒ…å†µ&lt;/li>
&lt;/ul>
&lt;p>åç»­ç”³è¯·è¯ä¹¦çš„å‘½ä»¤ï¼Œéƒ½æ˜¯åœ¨ root ç”¨æˆ·ä¸‹æ‰§è¡Œçš„ï¼Œè¯·å…ˆä½¿ç”¨ &lt;code>su&lt;/code> åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è¿›å…¥rootç”¨æˆ·&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>su
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… acme.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl https://get.acme.sh | sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># åˆ·æ–° shell å˜é‡é…ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">source&lt;/span> ~/.bashrc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å¯¼å…¥ Cloudflare API Token&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Token&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Account_ID&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Zone_ID&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è®¾ç½®é»˜è®¤ CA ä¸º Let&amp;#39;s Encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --set-default-ca --server letsencrypt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ RSA è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue --dns dns_cf -d xxx.xyz -d *.xxx.xyz --keylength 2048
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… RSA è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --install-cert -d domain.tld &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ ECC è¯ä¹¦ï¼Œè‹¥ä¸éœ€è¦ï¼Œè·³è¿‡å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue --dns dns_cf -d domain.tld -d *.domain.tld --keylength ec-256
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… ECC è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --install-cert -d domain.tld --ecc &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/ecc_domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/ecc_domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/ecc_domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">###############################ç¬¬äºŒä¸ªåŸŸå#####################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å–æ¶ˆç¯å¢ƒå˜é‡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">unset&lt;/span> CF_Token
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">unset&lt;/span> CF_Account_ID
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">unset&lt;/span> CF_Zone_ID
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è‡³æ­¤è¯ä¹¦å®‰è£…å®Œæ¯•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ä¸‹é¢æ˜¯åŒä¸€å°ä¸»æœºç”³è¯·ç¬¬äºŒä¸ªåŸŸåè¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å¯¼å…¥å¦ä¸€ä¸ª Cloudflare API Token&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Token&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Account_ID&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">export&lt;/span> &lt;span style="color:#666;font-weight:bold;font-style:italic">CF_Zone_ID&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä½œä¸º config homeï¼Œé»˜è®¤ä¼šæŠŠæ‰€æœ‰æ–‡ä»¶å­˜åœ¨è¿™é‡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir /root/.acme2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è®¾ç½®é»˜è®¤ CA ä¸º Let&amp;#39;s Encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 --set-default-ca --server letsencrypt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ RSA è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 --issue --dns dns_cf -d domain.tld -d *.domain.tld --keylength 2048
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… RSA è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--install-cert -d domain.tld &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç­¾å‘ ECC è¯ä¹¦ï¼Œè‹¥ä¸éœ€è¦ï¼Œè·³è¿‡å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 --issue --dns dns_cf -d domain.tld -d *.domain.tld --keylength ec-256
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å®‰è£… ECC è¯ä¹¦åˆ°æŒ‡å®šè·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --config-home /root/.acme2 &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--install-cert -d domain.tld --ecc &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--key-file /path/to/ssl/ecc_domain.tld_private.key &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--fullchain-file /path/to/ssl/ecc_domain.tld_chain.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--capath /path/to/ssl/ecc_domain.tld_ca.pem &lt;span style="color:#666;font-style:italic">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-style:italic">&lt;/span>--reloadcmd &lt;span style="color:#666;font-style:italic">&amp;#34;service nginx reload&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># æ‰‹åŠ¨æ·»åŠ å¦ä¸€ä¸ª cron ä»»åŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># crontab -e&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>50 0 * * * &lt;span style="color:#666;font-style:italic">&amp;#34;/root/.acme.sh&amp;#34;&lt;/span>/acme.sh --cron --home &lt;span style="color:#666;font-style:italic">&amp;#34;/root/.acme.sh&amp;#34;&lt;/span> --config-home &lt;span style="color:#666;font-style:italic">&amp;#34;/root/.acme2&amp;#34;&lt;/span> &amp;gt; /dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="ä¸¤ä¸ªæœåŠ¡çš„æ¯”è¾ƒ">
 ä¸¤ä¸ªæœåŠ¡çš„æ¯”è¾ƒ
 &lt;a class="anchor" href="#%e4%b8%a4%e4%b8%aa%e6%9c%8d%e5%8a%a1%e7%9a%84%e6%af%94%e8%be%83">#&lt;/a>
&lt;/h3>
&lt;h4 class="heading" id="ä¼˜ç‚¹">
 ä¼˜ç‚¹
 &lt;a class="anchor" href="#%e4%bc%98%e7%82%b9">#&lt;/a>
&lt;/h4>
&lt;ul>
&lt;li>acme.sh` + Let&amp;rsquo;s Encrypt + Cloudflare DNS
&lt;ol>
&lt;li>&lt;strong>è‡ªåŠ¨åŒ–&lt;/strong>ï¼š&lt;code>acme.sh&lt;/code> è„šæœ¬å¯ä»¥è‡ªåŠ¨å®Œæˆè¯ä¹¦çš„ç”³è¯·ã€éªŒè¯å’Œç»­æœŸè¿‡ç¨‹ã€‚&lt;/li>
&lt;li>&lt;strong>æ— éœ€å¼€æ”¾ 80/443 ç«¯å£&lt;/strong>ï¼šä½¿ç”¨ DNS éªŒè¯æ–¹å¼ï¼Œæ— éœ€åœ¨æœåŠ¡å™¨ä¸Šå¼€æ”¾ 80 æˆ– 443 ç«¯å£ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸ä¾èµ– Cloudflare ä»£ç†&lt;/strong>ï¼šè¿™ç§æ–¹å¼åªä½¿ç”¨ Cloudflare çš„ DNS æœåŠ¡ï¼Œä¸ä¾èµ– Cloudflare çš„ä»£ç†æœåŠ¡&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Cloudflare
&lt;ol>
&lt;li>&lt;strong>Universal SSL&lt;/strong>ï¼šCloudflare å…è´¹æä¾› Universal SSL è¯ä¹¦ï¼Œå¯ä»¥å¿«é€Ÿå¯ç”¨ HTTPSã€‚&lt;/li>
&lt;li>&lt;strong>Origin CA è¯ä¹¦&lt;/strong>ï¼šCloudflare æä¾› Origin CA è¯ä¹¦ï¼Œå¯ä»¥å®ç° Cloudflare åˆ°æºæœåŠ¡å™¨çš„åŠ å¯†è¿æ¥ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h4 class="heading" id="ç¼ºç‚¹">
 ç¼ºç‚¹
 &lt;a class="anchor" href="#%e7%bc%ba%e7%82%b9">#&lt;/a>
&lt;/h4>
&lt;ul>
&lt;li>acme.sh` + Let&amp;rsquo;s Encrypt + Cloudflare DNS
&lt;ol>
&lt;li>&lt;strong>é…ç½®ç›¸å¯¹å¤æ‚&lt;/strong>ï¼šç›¸æ¯”äºä½¿ç”¨ Cloudflare çš„ä¸€é”® SSL åŠŸèƒ½ï¼Œè¿™ç§æ–¹å¼éœ€è¦æ‰‹åŠ¨é…ç½® &lt;code>acme.sh&lt;/code> è„šæœ¬å’ŒæœåŠ¡å™¨ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸æä¾› DDoS é˜²æŠ¤å’Œå…¶ä»– Cloudflare åŠŸèƒ½&lt;/strong>ï¼šè¿™ç§æ–¹å¼åªä½¿ç”¨äº† Cloudflare çš„ DNS æœåŠ¡ï¼Œä¸æä¾› DDoS é˜²æŠ¤ã€CDN åŠ é€Ÿã€WAF ç­‰å…¶ä»– Cloudflare åŠŸèƒ½ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Cloudflare
&lt;ol>
&lt;li>&lt;strong>Origin CA è¯ä¹¦æµè§ˆå™¨ä¸ä¿¡ä»»&lt;/strong>ï¼šCloudflare çš„ Origin CA è¯ä¹¦ä¸è¢«æµè§ˆå™¨ä¿¡ä»»ï¼Œéœ€è¦é…åˆ Cloudflare çš„ä»£ç†æœåŠ¡ä½¿ç”¨ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h4 class="heading" id="åº”ç”¨åœºæ™¯æ¯”è¾ƒ">
 åº”ç”¨åœºæ™¯æ¯”è¾ƒ
 &lt;a class="anchor" href="#%e5%ba%94%e7%94%a8%e5%9c%ba%e6%99%af%e6%af%94%e8%be%83">#&lt;/a>
&lt;/h4>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>ç‰¹æ€§&lt;/th>
 &lt;th>&lt;code>acme.sh&lt;/code> + Let&amp;rsquo;s Encrypt + Cloudflare DNS&lt;/th>
 &lt;th>Cloudflare æœåŠ¡&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;strong>é€‚ç”¨åœºæ™¯&lt;/strong>&lt;/td>
 &lt;td>ä¸éœ€è¦ Cloudflare ä»£ç† &lt;!-- raw HTML omitted -->éœ€è¦åœ¨å…¶ä»–æœåŠ¡ä¸Šä½¿ç”¨è¯ä¹¦ &lt;!-- raw HTML omitted -->å¸Œæœ›å®Œå…¨æ§åˆ¶è¯ä¹¦&lt;/td>
 &lt;td>éœ€è¦ DDoS é˜²æŠ¤&lt;!-- raw HTML omitted -->éœ€è¦ CDN åŠ é€Ÿ&lt;!-- raw HTML omitted -->éœ€è¦ WAF&lt;!-- raw HTML omitted -->å¸Œæœ›éšè—æœåŠ¡å™¨ IP &lt;!-- raw HTML omitted -->éœ€è¦ç®€å•æ˜“ç”¨çš„ SSL é…ç½®&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>SSL è¯ä¹¦&lt;/strong>&lt;/td>
 &lt;td>Let&amp;rsquo;s Encrypt å…è´¹è¯ä¹¦&lt;/td>
 &lt;td>Cloudflare Universal SSL æˆ– Origin CA è¯ä¹¦&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ³›åŸŸåè¯ä¹¦&lt;/strong>&lt;/td>
 &lt;td>æ”¯æŒ&lt;/td>
 &lt;td>æ”¯æŒï¼ˆOrigin CA è¯ä¹¦éœ€é…åˆä»£ç†ä½¿ç”¨ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æœåŠ¡å™¨ IP&lt;/strong>&lt;/td>
 &lt;td>æš´éœ²&lt;/td>
 &lt;td>éšè—&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>DDoS é˜²æŠ¤&lt;/strong>&lt;/td>
 &lt;td>æ— &lt;/td>
 &lt;td>æœ‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>CDN åŠ é€Ÿ&lt;/strong>&lt;/td>
 &lt;td>æ— &lt;/td>
 &lt;td>æœ‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>WAF&lt;/strong>&lt;/td>
 &lt;td>æ— &lt;/td>
 &lt;td>æœ‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>é…ç½®éš¾åº¦&lt;/strong>&lt;/td>
 &lt;td>ç›¸å¯¹å¤æ‚&lt;/td>
 &lt;td>ç®€å•&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ§åˆ¶æƒ&lt;/strong>&lt;/td>
 &lt;td>å®Œå…¨æ§åˆ¶&lt;/td>
 &lt;td>éƒ¨åˆ†æ§åˆ¶&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>ä¾èµ–æ€§&lt;/strong>&lt;/td>
 &lt;td>ä»…ä¾èµ– Cloudflare DNS å’Œ Let&amp;rsquo;s Encrypt&lt;/td>
 &lt;td>ä¾èµ– Cloudflare çš„æ‰€æœ‰æœåŠ¡&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table></description></item><item><title>æœåŠ¡å™¨é…ç½®å®æˆ˜æŒ‡å—ï¼šä»å®‰å…¨åŠ å›ºåˆ°Nginxåä»£éƒ¨ç½²</title><link>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95/</link><pubDate>Fri, 12 Apr 2024 00:00:00 +0000</pubDate><guid>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95/</guid><description>&lt;h2 class="heading" id="å®‰å…¨æ€§">
 å®‰å…¨æ€§
 &lt;a class="anchor" href="#%e5%ae%89%e5%85%a8%e6%80%a7">#&lt;/a>
&lt;/h2>
&lt;p>å‚è€ƒ&lt;a href="https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/vps%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD/">VPSåŸºç¡€å®‰å…¨é…ç½®å®è·µæŒ‡å—&lt;/a>è¿›è¡Œé…ç½®&lt;/p>
&lt;hr>
&lt;h2 class="heading" id="å®‰è£…dockerå’Œdockercompose">
 å®‰è£…dockerå’Œdockercompose
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85docker%e5%92%8cdockercompose">#&lt;/a>
&lt;/h2>
&lt;h3 class="heading" id="å®‰è£…-docker">
 å®‰è£… Docker
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85-docker">#&lt;/a>
&lt;/h3>
&lt;h4 class="heading" id="æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨">
 æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨
 &lt;a class="anchor" href="#%e6%9b%b4%e6%96%b0%e8%bd%af%e4%bb%b6%e5%8c%85%e5%88%97%e8%a1%a8">#&lt;/a>
&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…">
 å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85%e5%bf%85%e8%a6%81%e7%9a%84%e8%bd%af%e4%bb%b6%e5%8c%85">#&lt;/a>
&lt;/h4>
&lt;p>å®‰è£…ä¸€äº›å¿…è¦çš„è½¯ä»¶åŒ…ï¼Œè¿™äº›è½¯ä»¶åŒ…å…è®¸ &lt;code>apt&lt;/code> é€šè¿‡ HTTPS ä½¿ç”¨ä»“åº“ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install apt-transport-https ca-certificates curl software-properties-common
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="æ·»åŠ -docker-çš„å®˜æ–¹-gpg-å¯†é’¥">
 æ·»åŠ  Docker çš„å®˜æ–¹ GPG å¯†é’¥
 &lt;a class="anchor" href="#%e6%b7%bb%e5%8a%a0-docker-%e7%9a%84%e5%ae%98%e6%96%b9-gpg-%e5%af%86%e9%92%a5">#&lt;/a>
&lt;/h4>
&lt;p>æ·»åŠ  Docker çš„å®˜æ–¹ GPG å¯†é’¥ï¼Œä»¥ä¾¿éªŒè¯ä¸‹è½½çš„è½¯ä»¶åŒ…ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="æ·»åŠ -docker-ä»“åº“">
 æ·»åŠ  Docker ä»“åº“
 &lt;a class="anchor" href="#%e6%b7%bb%e5%8a%a0-docker-%e4%bb%93%e5%ba%93">#&lt;/a>
&lt;/h4>
&lt;p>å°† Docker çš„å®˜æ–¹ä»“åº“æ·»åŠ åˆ°ä½ çš„ &lt;code>apt&lt;/code> è½¯ä»¶æºåˆ—è¡¨ä¸­ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;font-style:italic">echo&lt;/span> &lt;span style="color:#666;font-style:italic">&amp;#34;deb [arch=&lt;/span>&lt;span style="font-weight:bold;text-decoration:underline">$(&lt;/span>dpkg --print-architecture&lt;span style="font-weight:bold;text-decoration:underline">)&lt;/span>&lt;span style="color:#666;font-style:italic"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu &lt;/span>&lt;span style="font-weight:bold;text-decoration:underline">$(&lt;/span>lsb_release -cs&lt;span style="font-weight:bold;text-decoration:underline">)&lt;/span>&lt;span style="color:#666;font-style:italic"> stable&amp;#34;&lt;/span> | sudo tee /etc/apt/sources.list.d/docker.list &amp;gt; /dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†æ¬¡æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨ï¼Œä»¥åŒ…å«æ–°æ·»åŠ çš„ Docker ä»“åº“ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="å®‰è£…-docker-engine">
 å®‰è£… Docker Engine
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85-docker-engine">#&lt;/a>
&lt;/h4>
&lt;p>å®‰è£…&lt;code>Docker Engineã€Docker CLI&lt;/code>å’Œ&lt;code> Containerd&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install docker-ce docker-ce-cli containerd.io
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="éªŒè¯-docker-å®‰è£…">
 éªŒè¯ Docker å®‰è£…
 &lt;a class="anchor" href="#%e9%aa%8c%e8%af%81-docker-%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h4>
&lt;p>éªŒè¯ Docker æ˜¯å¦æˆåŠŸå®‰è£…ï¼Œå¹¶æ£€æŸ¥ Docker æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl status docker
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœ Docker æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼ &lt;code>active (running)&lt;/code> çš„è¾“å‡ºã€‚&lt;/p>
&lt;p>ä¹Ÿå¯ä»¥è¿è¡Œä¸€ä¸ªç®€å•çš„ Docker é•œåƒæ¥éªŒè¯ Docker æ˜¯å¦å¯ä»¥æ­£å¸¸å·¥ä½œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo docker run hello-world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åº”è¯¥çœ‹åˆ°ä¸€æ¡æ¬¢è¿æ¶ˆæ¯ï¼Œè¡¨æ˜ Docker å®‰è£…æˆåŠŸã€‚&lt;/p>
&lt;h3 class="heading" id="å®‰è£…-docker-composev2-å¯è·³è¿‡">
 å®‰è£… Docker Compose&lt;strong>V2&lt;/strong> (å¯è·³è¿‡)
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85-docker-composev2-%e5%8f%af%e8%b7%b3%e8%bf%87">#&lt;/a>
&lt;/h3>
&lt;p>Docker å®˜æ–¹ä¸ºäº†ç®€åŒ–å¼€å‘è€…çš„å®‰è£…å’Œä½¿ç”¨æµç¨‹ï¼Œå·²ç»å°† Docker Compose V2 ä½œä¸ºä¸€ä¸ªæ ¸å¿ƒæ’ä»¶ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨æ ‡å‡†çš„ Docker Engine (&lt;code>docker-ce&lt;/code>) å®‰è£…åŒ…çš„&lt;strong>ä¾èµ–&lt;/strong>æˆ–&lt;strong>æ¨è&lt;/strong>åˆ—è¡¨ä¸­ã€‚&lt;/p>
&lt;p>è¿™æ„å‘³ç€ï¼Œå½“ä¸Šé¢æ­¥éª¤ä¸­ä½¿ç”¨ &lt;code>apt&lt;/code> å®‰è£… &lt;code>docker-ce&lt;/code> æ—¶ï¼Œ&lt;code>apt&lt;/code> ä¼šè‡ªåŠ¨è§£æè¿™äº›ä¾èµ–å…³ç³»ï¼Œå¹¶å°† &lt;code>docker-compose-plugin&lt;/code> ä¸€å¹¶å®‰è£…ã€‚&lt;/p>
&lt;p>åˆ°è¿™ä¸€æ­¥ç›´æ¥ä½¿ç”¨&lt;code>docker compose version&lt;/code>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸã€‚&lt;/p>
&lt;h4 class="heading" id="ä¸‹è½½-docker-compose-æ’ä»¶">
 ä¸‹è½½ Docker Compose æ’ä»¶
 &lt;a class="anchor" href="#%e4%b8%8b%e8%bd%bd-docker-compose-%e6%8f%92%e4%bb%b6">#&lt;/a>
&lt;/h4>
&lt;p>ä» GitHub Releases ä¸‹è½½ Docker Compose æ’ä»¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install docker-compose-plugin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 class="heading" id="éªŒè¯-docker-compose-å®‰è£…">
 éªŒè¯ Docker Compose å®‰è£…
 &lt;a class="anchor" href="#%e9%aa%8c%e8%af%81-docker-compose-%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h4>
&lt;p>éªŒè¯ Docker Compose æ˜¯å¦æˆåŠŸå®‰è£…ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker compose version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœ Docker Compose æˆåŠŸå®‰è£…ï¼Œåº”è¯¥çœ‹åˆ° Docker Compose çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚&lt;/p>
&lt;h3 class="heading" id="æ·»åŠ ç”¨æˆ·åˆ°-docker-ç”¨æˆ·ç»„">
 æ·»åŠ ç”¨æˆ·åˆ° Docker ç”¨æˆ·ç»„
 &lt;a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7%e5%88%b0-docker-%e7%94%a8%e6%88%b7%e7%bb%84">#&lt;/a>
&lt;/h3>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ &lt;code>root&lt;/code> ç”¨æˆ·æˆ–å…·æœ‰ &lt;code>sudo&lt;/code> æƒé™çš„ç”¨æˆ·æ‰èƒ½è¿è¡Œ Docker å‘½ä»¤ã€‚ä¸ºäº†è®©æ™®é€šç”¨æˆ·ä¹Ÿèƒ½è¿è¡Œ Docker å‘½ä»¤ï¼Œä½ éœ€è¦å°†ç”¨æˆ·æ·»åŠ åˆ° &lt;code>docker&lt;/code> ç”¨æˆ·ç»„ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo usermod -aG docker &lt;span style="color:#666;font-weight:bold;font-style:italic">$USER&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åº”ç”¨ç”¨æˆ·ç»„æ›´æ”¹ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>newgrp docker
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·å°±å¯ä»¥åœ¨ä¸ä½¿ç”¨ &lt;code>sudo&lt;/code> çš„æƒ…å†µä¸‹è¿è¡Œ Docker å‘½ä»¤äº†ã€‚&lt;/p>
&lt;hr>
&lt;h2 class="heading" id="é…ç½®è¯ä¹¦å’Œåä»£">
 é…ç½®è¯ä¹¦å’Œåä»£
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae%e8%af%81%e4%b9%a6%e5%92%8c%e5%8f%8d%e4%bb%a3">#&lt;/a>
&lt;/h2>
&lt;h3 class="heading" id="ä¸‹è½½è¯ä¹¦å’Œç§é’¥">
 ä¸‹è½½è¯ä¹¦å’Œç§é’¥
 &lt;a class="anchor" href="#%e4%b8%8b%e8%bd%bd%e8%af%81%e4%b9%a6%e5%92%8c%e7%a7%81%e9%92%a5">#&lt;/a>
&lt;/h3>
&lt;p>å°†åœ¨cfä¸­ç”Ÿæˆçš„æºè¯ä¹¦çš„certå’Œkeyå¤åˆ¶åˆ°.pemå’Œ.keyæ–‡ä»¶ä¸­&lt;/p>
&lt;p>











&lt;figure class="">

 &lt;div class="img-container" >
 &lt;img loading="lazy" alt="20250717203617645" src="https://webp.050612.xyz/2025/07/20250717203617645.png" >
 &lt;/div>

 
&lt;/figure>
&lt;/p>
&lt;h3 class="heading" id="å®‰è£…-nginx">
 å®‰è£… nginx
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85-nginx">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="ä¸Šä¼ è¯ä¹¦å’Œç§é’¥åˆ°æœåŠ¡å™¨">
 ä¸Šä¼ è¯ä¹¦å’Œç§é’¥åˆ°æœåŠ¡å™¨
 &lt;a class="anchor" href="#%e4%b8%8a%e4%bc%a0%e8%af%81%e4%b9%a6%e5%92%8c%e7%a7%81%e9%92%a5%e5%88%b0%e6%9c%8d%e5%8a%a1%e5%99%a8">#&lt;/a>
&lt;/h3>
&lt;p>ä»¥ä¸‹æ“ä½œå»ºè®®ææƒä¸ºrootè¿›è¡Œæ“ä½œå’Œæ£€æŸ¥&lt;/p>
&lt;ol>
&lt;li>ä½¿ç”¨suï¼Œè¾“å…¥rootå¯†ç ææƒ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>su
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>æ£€æŸ¥ &lt;code>/etc/ssl/certs&lt;/code>å’Œ&lt;code>/etc/ssl/private&lt;/code>ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶å°†.pemå’Œ.keyæ–‡ä»¶åˆ†åˆ«ä¼ åˆ°è¿™ä¸¤ä¸ªç›®å½•é‡Œ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo mv xxx.com.pem /etc/ssl/certs/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo mv xxx.com.key /etc/ssl/private/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>è®¾ç½®æƒé™&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span> sudo chmod 600 /etc/ssl/private/api.xxx.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 class="heading" id="é…ç½®nginx">
 é…ç½®nginx
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%aenginx">#&lt;/a>
&lt;/h2>
&lt;ol>
&lt;li>&lt;strong>åˆ›å»º Nginx é…ç½®æ–‡ä»¶&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/nginx/sites-available/api.xxx.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>æ·»åŠ ä»¥ä¸‹é…ç½®&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-txt" data-lang="txt">&lt;span style="display:flex;">&lt;span>server {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen 80;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_name api.xxx.com;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> return 301 https://$host$request_uri;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen 443 ssl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_name api.xxx.com;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ssl_certificate /etc/ssl/certs/api.xxx.com.pem;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ssl_certificate_key /etc/ssl/private/api.xxx.com.key;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ssl_protocols TLSv1.2 TLSv1.3; # æ ¹æ®éœ€è¦è°ƒæ•´
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ssl_ciphers HIGH:!aNULL:!MD5; # æ ¹æ®éœ€è¦è°ƒæ•´
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client_max_body_size 100m;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> location / {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> proxy_pass http://127.0.0.1:5005; # æ›¿æ¢ä¸ºä½ çš„ chat2api æœåŠ¡ç›‘å¬çš„åœ°å€å’Œç«¯å£
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> proxy_set_header Host $host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> proxy_set_header X-Real-IP $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> proxy_set_header X-Forwarded-Proto $scheme;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>æ³¨æ„ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;code>server_name&lt;/code>ï¼šè®¾ç½®ä¸ºÂ &lt;code>api.xxx.com&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>ssl_certificate&lt;/code>ï¼šæŒ‡å‘&lt;code>.pem&lt;/code>è¯ä¹¦æ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/li>
&lt;li>&lt;code>ssl_certificate_key&lt;/code>ï¼šæŒ‡å‘&lt;code>.key&lt;/code>ç§é’¥æ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/li>
&lt;li>&lt;code>proxy_pass&lt;/code>ï¼šè®¾ç½®ä¸º`æœåŠ¡ç›‘å¬çš„åœ°å€å’Œç«¯å£&lt;/li>
&lt;li>ç¬¬ä¸€ä¸ªÂ &lt;code>server&lt;/code>Â å—ç”¨äºå°† HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPS&lt;/li>
&lt;/ul>
&lt;ol start="3">
&lt;li>&lt;strong>å¯ç”¨ Nginx é…ç½®&lt;/strong>&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>åˆ›å»ºè½¯é“¾æ¥åˆ°Â &lt;code>sites-enabled&lt;/code>Â ç›®å½•ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ln -s /etc/nginx/sites-available/api.vtofun.me /etc/nginx/sites-enabled/api.vtofun.me
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>ç§»é™¤é»˜è®¤çš„ Nginx é…ç½®ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo rm /etc/nginx/sites-enabled/default
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>æµ‹è¯• Nginx é…ç½®ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo nginx -t
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>é‡å¯ Nginx æœåŠ¡ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl restart nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 class="heading" id="swap-ç©ºé—´é…ç½®">
 Swap ç©ºé—´é…ç½®
 &lt;a class="anchor" href="#swap-%e7%a9%ba%e9%97%b4%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;h3 class="heading" id="åˆ›å»ºswapç©ºé—´">
 åˆ›å»ºswapç©ºé—´
 &lt;a class="anchor" href="#%e5%88%9b%e5%bb%baswap%e7%a9%ba%e9%97%b4">#&lt;/a>
&lt;/h3>
&lt;ol>
&lt;li>æ£€æŸ¥ Swap ç©ºé—´ï¼š
é¦–å…ˆï¼Œæ£€æŸ¥ç³»ç»Ÿå½“å‰æ˜¯å¦å·²ç»é…ç½®äº† Swap ç©ºé—´ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>free -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>åˆ›å»º Swap æ–‡ä»¶ï¼š
ä½¿ç”¨ &lt;code>fallocate&lt;/code> å‘½ä»¤åˆ›å»ºä¸€ä¸ª Swap æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ª 2GB çš„ Swap æ–‡ä»¶ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo fallocate -l 2G /swapfile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code>dd&lt;/code> å‘½ä»¤åˆ›å»º Swap æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo dd &lt;span style="font-weight:bold;text-decoration:underline">if&lt;/span>=/dev/zero &lt;span style="color:#666;font-weight:bold;font-style:italic">of&lt;/span>=/swapfile &lt;span style="color:#666;font-weight:bold;font-style:italic">bs&lt;/span>=1M &lt;span style="color:#666;font-weight:bold;font-style:italic">count&lt;/span>=2048
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™å°†åˆ›å»ºä¸€ä¸ªåä¸º &lt;code>/swapfile&lt;/code>ï¼Œå¤§å°ä¸º 2GB çš„æ–‡ä»¶ã€‚å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ &lt;code>count&lt;/code> çš„å€¼æ¥æ”¹å˜ Swap æ–‡ä»¶çš„å¤§å°ã€‚
3. è®¾ç½® Swap æ–‡ä»¶æƒé™ï¼š&lt;/p>
&lt;p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œè®¾ç½® Swap æ–‡ä»¶çš„æƒé™ï¼Œåªå…è®¸ root ç”¨æˆ·è¯»å†™ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo chmod 600 /swapfile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>æ ¼å¼åŒ–ä¸º Swap ç©ºé—´ï¼š
ä½¿ç”¨ &lt;code>mkswap&lt;/code> å‘½ä»¤å°†æ–‡ä»¶æ ¼å¼åŒ–ä¸º Swap ç©ºé—´ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo mkswap /swapfile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>å¯ç”¨ Swap ç©ºé—´ï¼š
ä½¿ç”¨ &lt;code>swapon&lt;/code> å‘½ä»¤å¯ç”¨ Swap ç©ºé—´ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo swapon /swapfile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="6">
&lt;li>éªŒè¯ Swap ç©ºé—´ï¼š
å†æ¬¡ä½¿ç”¨ &lt;code>free -h&lt;/code> å‘½ä»¤éªŒè¯ Swap ç©ºé—´æ˜¯å¦å·²å¯ç”¨ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>free -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åº”è¯¥èƒ½çœ‹åˆ° &lt;code>Swap&lt;/code> é‚£ä¸€è¡Œæ˜¾ç¤ºäº†ä½ åˆšåˆšé…ç½®çš„ Swap ç©ºé—´å¤§å°ã€‚&lt;/p>
&lt;ol start="7">
&lt;li>è®¾ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½ Swap ç©ºé—´ï¼š&lt;/li>
&lt;/ol>
&lt;p>ä¸ºäº†ä½¿ Swap ç©ºé—´åœ¨ç³»ç»Ÿé‡å¯åä»ç„¶æœ‰æ•ˆï¼Œéœ€è¦å°†å…¶æ·»åŠ åˆ° &lt;code>/etc/fstab&lt;/code> æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€è¯¥æ–‡ä»¶ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo vim /etc/fstab
&lt;/code>&lt;/pre>&lt;p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹ä¸€è¡Œï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>/swapfile swap swap defaults 0 0
&lt;/code>&lt;/pre>&lt;ol start="8">
&lt;li>è°ƒæ•´ Swappiness å€¼ï¼ˆå¯é€‰ï¼‰ï¼š
&lt;code>swappiness&lt;/code> å‚æ•°æ§åˆ¶å†…æ ¸ä½¿ç”¨ Swap ç©ºé—´çš„ç§¯æç¨‹åº¦ã€‚é»˜è®¤å€¼é€šå¸¸æ˜¯ 60ã€‚å¯¹äºæœåŠ¡å™¨ï¼Œä½ å¯èƒ½å¸Œæœ›é™ä½è¿™ä¸ªå€¼ï¼Œä»¥ä¾¿ç³»ç»Ÿæ›´å€¾å‘äºä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶æ‰ä½¿ç”¨ Swap ç©ºé—´ã€‚&lt;/li>
&lt;/ol>
&lt;p>æŸ¥çœ‹å½“å‰çš„ &lt;code>swappiness&lt;/code> å€¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>cat /proc/sys/vm/swappiness
&lt;/code>&lt;/pre>&lt;p>ä¸´æ—¶ä¿®æ”¹ &lt;code>swappiness&lt;/code> å€¼ï¼ˆä¾‹å¦‚è®¾ç½®ä¸º 10ï¼‰ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo sysctl vm.swappiness=10
&lt;/code>&lt;/pre>&lt;p>æ°¸ä¹…ä¿®æ”¹ &lt;code>swappiness&lt;/code> å€¼ï¼Œç¼–è¾‘ &lt;code>/etc/sysctl.conf&lt;/code> æ–‡ä»¶ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo nano /etc/sysctl.conf
&lt;/code>&lt;/pre>&lt;p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹è¡Œï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>vm.swappiness=10
&lt;/code>&lt;/pre>&lt;h3 class="heading" id="åœç”¨swapç©ºé—´">
 åœç”¨swapç©ºé—´
 &lt;a class="anchor" href="#%e5%81%9c%e7%94%a8swap%e7%a9%ba%e9%97%b4">#&lt;/a>
&lt;/h3>
&lt;ol>
&lt;li>å…³é—­ Swap ç©ºé—´ï¼š
ä½¿ç”¨ &lt;code>swapoff&lt;/code> å‘½ä»¤å…³é—­æŒ‡å®šçš„ Swap ç©ºé—´ã€‚å¦‚æœä½ çš„ Swap ç©ºé—´æ˜¯åŸºäºæ–‡ä»¶çš„ï¼ˆå¦‚å‰é¢ç¤ºä¾‹ä¸­çš„ &lt;code>/swapfile&lt;/code>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code>sudo swapoff /swapfile
&lt;/code>&lt;/pre>&lt;p>ä¸ç¡®å®š Swap åˆ†åŒºçš„è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>swapon --show&lt;/code> æˆ– &lt;code>free -h&lt;/code> å‘½ä»¤æŸ¥çœ‹ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>åˆ é™¤ Swap æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code>sudo rm /swapfile
&lt;/code>&lt;/pre>&lt;ol start="3">
&lt;li>ç¼–è¾‘ &lt;code>/etc/fstab&lt;/code> æ–‡ä»¶ï¼š&lt;/li>
&lt;/ol>
&lt;p>ä¸ºäº†é˜²æ­¢ç³»ç»Ÿåœ¨é‡å¯åè‡ªåŠ¨æŒ‚è½½ Swap ç©ºé—´ï¼Œéœ€è¦ä» &lt;code>/etc/fstab&lt;/code> æ–‡ä»¶ä¸­åˆ é™¤æˆ–æ³¨é‡Šæ‰ç›¸å…³çš„æ¡ç›®ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo vim /etc/fstab
&lt;/code>&lt;/pre>&lt;p>æ‰¾åˆ°åŒ…å« &lt;code>/swapfile&lt;/code> çš„é‚£ä¸€è¡Œï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>/swapfile swap swap defaults 0 0
&lt;/code>&lt;/pre>&lt;p>åˆ é™¤è¿™ä¸€è¡Œï¼Œæˆ–è€…åœ¨è¡Œé¦–æ·»åŠ  &lt;code>#&lt;/code> å°†å…¶æ³¨é‡Šæ‰ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>#/swapfile swap swap defaults 0 0
&lt;/code>&lt;/pre>&lt;ol start="4">
&lt;li>éªŒè¯ Swap ç©ºé—´æ˜¯å¦å·²åœç”¨ï¼š&lt;/li>
&lt;/ol>
&lt;p>ä½¿ç”¨ &lt;code>free -h&lt;/code> å‘½ä»¤éªŒè¯ Swap ç©ºé—´æ˜¯å¦å·²åœç”¨ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>free -h
&lt;/code>&lt;/pre></description></item><item><title>VPSåŸºç¡€å®‰å…¨é…ç½®å®è·µæŒ‡å—</title><link>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/vps%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD/</link><pubDate>Wed, 10 Apr 2024 00:00:00 +0000</pubDate><guid>https://blog.yzyy.de/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/vps%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD/</guid><description>&lt;p>æœ¬æ–‡åŸºäºÂ &lt;code>@Raven95676&lt;/code>Â çš„åŸå¸–ï¼Œå¹¶ç»“åˆæˆ‘çš„ä¸ªäººä½¿ç”¨ä¹ æƒ¯è¿›è¡Œäº†å®šåˆ¶åŒ–æ•´ç†ï¼Œä½œä¸ºè‡ªå·±çš„æ“ä½œå¤‡å¿˜å½•ã€‚&lt;/p>
&lt;p>åŸå¸–åœ°å€ï¼š&lt;a href="https://linux.do/t/topic/267502">VPSåŸºæœ¬å®‰å…¨æªæ–½&lt;/a>&lt;/p>
&lt;h1 class="heading" id="å‰è¨€">
 å‰è¨€
 &lt;a class="anchor" href="#%e5%89%8d%e8%a8%80">#&lt;/a>
&lt;/h1>
&lt;p>éšç€é€æ¸çœ‹åˆ°ä¸€äº›ã€ŒSelf Hostã€çš„æœåŠ¡ï¼Œæ‹¥æœ‰ä¸€å°å±äºè‡ªå·±çš„æœåŠ¡å™¨çš„æƒ³æ³•è¶Šæ¥è¶Šå¼ºçƒˆã€‚ç»ˆäºï¼Œåœ¨24å¹´çš„ä¸€æ¬¡ä¿ƒé”€ä¸­ï¼Œä¹°åˆ°äº†ç¬¬ä¸€å°å…·æœ‰å…¬ç½‘IPçš„å°æœºå™¨ï¼Œ1c1gã€‚&lt;/p>
&lt;p>æ‹¿åˆ°äº†æœºå™¨ï¼Œå¼€æœºä¹‹åæ„å‘³ç€æš´éœ²åœ¨äº†äº’è”ç½‘ä¸­ã€‚åœ¨äº’è”ç½‘ä¸­ï¼Œæ¯æ—¶æ¯åˆ»éƒ½æœ‰æ— æ•°çš„æ¶æ„æµé‡å‘å‡ºã€‚æˆ‘ä»¬éœ€è¦åšä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p>
&lt;p>å¦‚æœé€‰æ‹©å°†ç½‘ç«™ / æœåŠ¡æ”¾åœ¨çŸ¥åå‚å•†è™šæ‹Ÿä¸»æœºä¸Šï¼Œè™šæ‹Ÿä¸»æœºçš„å‚å•†ä¼šè´Ÿè´£åŸºæœ¬çš„æœåŠ¡å™¨å®‰å…¨æªæ–½ã€‚ä½†å¦‚æœæ”¾åœ¨ VPS ä¸Šï¼Œé‚£ä¹ˆä½ å°±æ˜¯æœåŠ¡å™¨çš„å®‰å…¨è´Ÿè´£äººäº†ã€‚æ›´å¤šçš„æƒé™ä»£è¡¨ç€æ›´å¤šçš„ä¹‰åŠ¡ï¼ŒVPS åœ¨å…·æœ‰æ›´é«˜çš„è‡ªç”±åº¦çš„æƒ…å†µä¸‹è‡ªç„¶æœ‰æ›´é«˜çš„é£é™©ã€‚&lt;strong>è€Œæˆ‘ä»¬è¦åšåˆ°çš„ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼Œè€Œæ˜¯æ¯”å¤§å¤šæ•°äººå®‰å…¨ã€‚&lt;/strong>Â åªè¦åšåˆ°æ²¡é‚£ä¹ˆå®¹æ˜“è¢«æ”»ç ´é‚£å°±æ˜¯èƒœåˆ©ã€‚&lt;/p>
&lt;h2 class="heading" id="å®‰å…¨ç®¡ç†ç³»ç»Ÿ">
 å®‰å…¨ç®¡ç†ç³»ç»Ÿ
 &lt;a class="anchor" href="#%e5%ae%89%e5%85%a8%e7%ae%a1%e7%90%86%e7%b3%bb%e7%bb%9f">#&lt;/a>
&lt;/h2>
&lt;p>æœ‰äº› VPS å‚å•†é»˜è®¤æä¾›çš„æ˜¯ root è´¦æˆ·ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œroot è´¦æˆ·æ‹¥æœ‰æ•´ä¸ªç³»ç»Ÿæœ€é«˜çš„æƒé™ï¼Œè¿™ä¹ˆé«˜çš„æƒé™è‡ªç„¶æ˜¯ä¸å®‰å…¨çš„ã€‚æ­£ç¡®çš„åšæ³•æ˜¯åˆ›å»ºä¸€ä¸ªé root è´¦æˆ·ï¼Œåœ¨å¿…é¡»ä½¿ç”¨ root æƒé™æ—¶ä½¿ç”¨ sudo ææƒã€‚&lt;/p>
&lt;h3 class="heading" id="åˆ›å»ºé-root-è´¦æˆ·">
 åˆ›å»ºé root è´¦æˆ·
 &lt;a class="anchor" href="#%e5%88%9b%e5%bb%ba%e9%9d%9e-root-%e8%b4%a6%e6%88%b7">#&lt;/a>
&lt;/h3>
&lt;p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªå…·æœ‰ææƒèƒ½åŠ›çš„è´¦æˆ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>useradd -m -G sudo -s /bin/bash ç”¨æˆ·å
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;strong>&lt;code>useradd&lt;/code>:&lt;/strong>Â è¿™æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºæ–°ç”¨æˆ·çš„å‘½ä»¤ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>-m&lt;/code>:&lt;/strong>Â æ­¤é€‰é¡¹ä¼šåœ¨Â &lt;code>/home&lt;/code>Â ç›®å½•ä¸‹ä¸ºæ–°ç”¨æˆ·åˆ›å»ºä¸»ç›®å½•ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>-G sudo&lt;/code>:&lt;/strong>Â æ­¤é€‰é¡¹å°†æ–°ç”¨æˆ·æ·»åŠ åˆ°Â &lt;code>sudo&lt;/code>Â ç»„ï¼Œå…è®¸å…¶ä½¿ç”¨Â &lt;code>sudo&lt;/code>Â å‘½ä»¤æ‰§è¡Œç®¡ç†å‘˜æ“ä½œã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>-s /bin/bash&lt;/code>:&lt;/strong>Â æ­¤é€‰é¡¹æŒ‡å®šæ–°ç”¨æˆ·çš„é»˜è®¤ shell ä¸ºÂ &lt;code>/bin/bash&lt;/code>ï¼ˆå¸¸ç”¨ shellï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>ç”¨æˆ·å&lt;/code>:&lt;/strong>Â è¿™æ˜¯ä½ è¦åˆ›å»ºçš„æ–°ç”¨æˆ·çš„ç”¨æˆ·åã€‚&lt;/li>
&lt;/ul>
&lt;p>ç„¶åæˆ‘ä»¬ç»™è¿™ä¸ªç”¨æˆ·è®¾ç½®ä¸€ä¸ªè‡³å°‘ä¸º 16 ä½çš„éšæœºå¤§å°å†™å­—æ¯ + æ•°å­—çš„å¯†ç ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-undefined" data-lang="undefined">passwd ç”¨æˆ·å
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>å»ºè®®æŠŠ root ç”¨æˆ·çš„å¯†ç ä¹Ÿæ”¹æ‰ï¼Œäº‘æœåŠ¡å™¨çš„é»˜è®¤å¯†ç å¼ºåº¦è¿˜æ˜¯å·®ç‚¹ï¼Œè€Œä¸”æœ‰äº›æœåŠ¡å•†ä¼šé€šè¿‡é‚®ä»¶æ¥å‘é€é»˜è®¤å¯†ç ï¼Œä¸å¤ªå®‰å…¨ã€‚&lt;/p>&lt;/blockquote>
&lt;h3 class="heading" id="ç¦ç”¨-root-ssh-å¯†ç ç™»é™†">
 ç¦ç”¨ root SSH å¯†ç ç™»é™†
 &lt;a class="anchor" href="#%e7%a6%81%e7%94%a8-root-ssh-%e5%af%86%e7%a0%81%e7%99%bb%e9%99%86">#&lt;/a>
&lt;/h3>
&lt;p>å…ˆä¸æ root ç™»å½•æœ¬èº«å°±æ˜¯å±é™©çš„è¡Œä¸ºï¼Œroot è´¦æˆ·çš„ç”¨æˆ·åå›ºå®šä¸ºâ€rootâ€ï¼Œå¦‚æœå…è®¸å…¶é€šè¿‡å¯†ç ç™»å½•ï¼Œæ”»å‡»è€…åªéœ€è¿›è¡Œå¯†ç ç©·ä¸¾å³å¯å°è¯•æ”»ç ´ç³»ç»Ÿã€‚ä¹‹å‰æˆ‘ä»¬å·²ç»åˆ›å»ºäº†é root è´¦æˆ·ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç¦ç”¨é root è´¦æˆ·çš„ SSH ç™»å½•å³å¯ã€‚&lt;/p>
&lt;p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç¼–è¾‘ SSH é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># ç¦æ­¢ Root ç”¨æˆ·é€šè¿‡å¯†ç è¿œç¨‹ç™»å½• &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PermitRootLogin prohibit-password
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥çœ‹&lt;code>/etc/ssh/sshd_config.d/&lt;/code>ç›®å½•ä¸‹æœ‰æ— å…¶ä»–é…ç½®æ–‡ä»¶ï¼Œé˜²æ­¢ä¸ç”Ÿæ•ˆã€‚æœ‰äº›å‚å•†çš„åˆå§‹é•œåƒå†…å·²ç»æœ‰äº†ä¸€äº›é…ç½®ä¼šè¦†ç›–æ‰æˆ‘ä»¬ç¼–å†™çš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ls /etc/ssh/sshd_config.d/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹åé‡å¯ SSH æœåŠ¡ç”Ÿæ•ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl restart ssh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºä»€ä¹ˆä¸è®¾ç½®æˆ noï¼š&lt;/p>
&lt;p>åº„ sir:&lt;/p>
&lt;blockquote>
&lt;p>å¦ï¼Œç›´æ¥ç¦æ‰ root ç™»å½•Â &lt;code>PermitRootLogin no&lt;/code>Â æˆ‘ä¹Ÿä¸å¸¸ç”¨ï¼Œæ›´ä¹ æƒ¯å’Œå…¶ä»– sudoer ä¸€æ ·é…å¯†é’¥ç„¶åç¦æ­¢å¯†ç ç™»å½•ä»…å…è®¸å¯†é’¥ç™»å½•ã€‚æˆ‘æ˜¯ä¸€èˆ¬èƒ½æ“åšçº¿ä¸‹é›†ç¾¤çš„æœºå­æ‰ä¼šè¿™ä¹ˆé…ï¼Œä¸ç„¶å‡ºä¸ªæ•…éšœæ²¡ root ç”¨ä¸äº†äº†ï¼Œæ¯”å¦‚å­˜å‚¨æ»¡äº†è¿œç¨‹ ssh session éƒ½å»ºç«‹ä¸äº†ã€‚&lt;/p>&lt;/blockquote>
&lt;p>Oganneson:&lt;/p>
&lt;blockquote>
&lt;p>ç†è®ºä¸Š PermitRootLogin æ˜¯å¥½çš„ï¼Œä½†åœ¨æœåŠ¡å™¨å¯„æ‰éœ€è¦æ•‘æ´æ—¶å°±ä¼šå˜éº»çƒ¦ï¼Œæˆ‘å…¶å®æ›´æ¨èåªå…³é—­è¿œç¨‹å¯†ç ç™»å½•ï¼Œä¿ç•™æœ¬åœ°å¯†ç ç™»å½•ï¼Œå‡ºé—®é¢˜æ—¶å¯ä»¥é€šè¿‡ vnc æˆ–è€… ipmi æœ¬åœ°ç™»å½• root è¿›è¡Œæ•‘æ´ã€‚&lt;/p>&lt;/blockquote>
&lt;h3 class="heading" id="ä¿®æ”¹-ssh-ç«¯å£å·">
 ä¿®æ”¹ SSH ç«¯å£å·
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9-ssh-%e7%ab%af%e5%8f%a3%e5%8f%b7">#&lt;/a>
&lt;/h3>
&lt;blockquote>
&lt;p>ç™»ä¸Šå»ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ”¹ SSHD çš„ ç«¯å£å¹¶ä¿®æ”¹é˜²ç«å¢™ï¼Œ22 å…¨æ˜¯çŒœå¯†ç çš„è¯·æ±‚ã€‚&lt;br>
æœ‰ä¸ªå°æŠ€å·§ï¼Œå°±æ˜¯æ”¹ç«¯å£å¹¶é‡å¯ sshd åå½“å‰çš„è¿æ¥å¹¶æ²¡æœ‰æ–­ï¼Œæ–°å»ºä¸€ä¸ªç»ˆç«¯ä½¿ç”¨æ–°ç«¯å£å‘è¯·æ±‚ï¼Œèƒ½è¿ä¸Šå°±æ˜¯ä¿®æ”¹æ­£ç¡®ï¼Œè¦æ˜¯ä¸èƒ½å»ºç«‹æ–°è¿æ¥ï¼Œè¿˜å¯ä»¥æ”¹å›æ¥ï¼Œæˆ–æŸ¥ä¸‹é˜²ç«å¢™çš„é…ç½®ã€‚&lt;/p>&lt;/blockquote>
&lt;p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥é€šè¿‡ &lt;code>sudo vim /etc/ssh/sshd_config&lt;/code> ä¿®æ”¹ SSH ç«¯å£ï¼Œç„¶åå†ä½¿ç”¨ &lt;code>sudo systemctl restart ssh.service&lt;/code> é‡å¯ SSH æœåŠ¡åº”ç”¨æ›´æ”¹æ˜¯å¯è¡Œçš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># è®¾ç½® SSHç«¯å£ Port è‡ªæ‹Ÿ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Port 20251
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†æ˜¯åœ¨ &lt;strong>Ubuntu 22.10 æˆ–æ›´é«˜ç‰ˆæœ¬&lt;/strong>ä¸­å„ä½å¯èƒ½å‘ç°è¿™æ˜¯&lt;strong>æ— æ•ˆ&lt;/strong>çš„ï¼Œå„ä½ä¼šå‘ç° SSH æœåŠ¡åœ¨é‡å¯åä¾ç„¶ç›‘å¬åŸç«¯å£ã€‚&lt;/p>
&lt;p>å› ä¸ºåœ¨ Ubuntu 22.10 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œssh é»˜è®¤é€šè¿‡å¥—æ¥å­—æ¿€æ´»ã€‚&lt;/p>
&lt;p>åœ¨ Ubuntu 22.10ã€Ubuntu 23.04 å’Œ Ubuntu 23.10 ä¸­è¿›è¡Œä¿®æ”¹çš„æ–¹æ³•æ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo mkdir -p /etc/systemd/system/ssh.socket.d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo vim /etc/systemd/system/ssh.socket.d/listen.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl restart ssh.socket
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl restart ssh.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>listen.conf çš„å‚è€ƒé…ç½®ä¸ºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;text-decoration:underline">[Socket]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ListenStream=
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ListenStream=&lt;span style="color:#666;font-style:italic">2233&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨ Ubuntu 24.04 ä¸­è¿›è¡Œä¿®æ”¹çš„æ–¹æ³•æ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl restart ssh.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœä¸åœ¨ä¹é€šè¿‡å¥—æ¥å­—æ¿€æ´»èŠ‚çœçš„å†…å­˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¢å¤åˆ°éå¥—æ¥å­—æ¿€æ´»ï¼š&lt;/p>
&lt;p>&lt;strong>è­¦å‘Šï¼š&lt;/strong> åŠ¡å¿…ç¡®è®¤é…ç½®æ–‡ä»¶æ­£å¸¸ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl disable --now ssh.socket
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl &lt;span style="font-weight:bold;font-style:italic">enable&lt;/span> --now ssh.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœ‰é…ç½®è¿ç§»ï¼ˆUbuntu 22.10 åŠä»¥ä¸Šï¼ŒUbuntu 24.04 ä»¥ä¸‹ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl disable --now ssh.socket
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rm -f /etc/systemd/system/ssh.service.d/00-socket.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rm -f /etc/systemd/system/ssh.socket.d/addresses.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl &lt;span style="font-weight:bold;font-style:italic">enable&lt;/span> --now ssh.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="fail2ban-é˜²æš´åŠ›ç ´è§£-ssh-é…ç½®ssh-ipç™½åå•">
 Fail2ban é˜²æš´åŠ›ç ´è§£ SSH é…ç½®SSH ipç™½åå•
 &lt;a class="anchor" href="#fail2ban-%e9%98%b2%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3-ssh-%e9%85%8d%e7%bd%aessh-ip%e7%99%bd%e5%90%8d%e5%8d%95">#&lt;/a>
&lt;/h3>
&lt;p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Fail2banï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install fail2ban
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®‰è£…å®Œæˆå Fail2banä¼šè‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹æœåŠ¡çŠ¶æ€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl status fail2ban
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœä¸ºdeadï¼Œæ³¨æ„å¼€å¯fail2banæœåŠ¡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl start fail2ban
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®˜æ–¹æ¨èçš„åšæ³•æ˜¯åˆ©ç”¨ jail.local æ¥è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®ï¼š
è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨å‡çº§ Fail2ban æ—¶ï¼Œä½ çš„è‡ªå®šä¹‰é…ç½®ä¸ä¼šä¸¢å¤±ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/fail2ban/jail.local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥å‚ç…§ä»¥ä¸‹é…ç½®æ–‡ä»¶æ¥è¿›è¡Œè‡ªå·±çš„é…ç½®ï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="font-weight:bold;text-decoration:underline">[sshd]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ignoreip = &lt;span style="color:#666;font-style:italic">127.0.0.1/8 # ç™½åå•ï¼ŒçŸ¥é“è‡ªå·±çš„å›ºå®šå…¬ç½‘ipç½‘æ®µå¯ä»¥é…ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>enabled = &lt;span style="color:#666;font-style:italic">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>filter = &lt;span style="color:#666;font-style:italic">sshd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>port = &lt;span style="color:#666;font-style:italic">22 # ç«¯å£ï¼Œæ”¹äº†çš„è¯è¿™é‡Œä¹Ÿè¦æ”¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>maxretry = &lt;span style="color:#666;font-style:italic">5 # æœ€å¤§å°è¯•æ¬¡æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>findtime = &lt;span style="color:#666;font-style:italic">300 # å¤šå°‘ç§’ä»¥å†…æœ€å¤§å°è¯•æ¬¡æ•°è§„åˆ™ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bantime = &lt;span style="color:#666;font-style:italic">600 # å°ç¦å¤šå°‘ç§’ï¼Œ-1æ˜¯æ°¸ä¹…å°ç¦ï¼ˆä¸å»ºè®®æ°¸ä¹…å°ç¦ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>action = &lt;span style="color:#666;font-style:italic">%(action_)s[port=&amp;#34;%(port)s&amp;#34;, protocol=&amp;#34;%(protocol)s&amp;#34;, logpath=&amp;#34;%(logpath)s&amp;#34;, chain=&amp;#34;%(chain)s&amp;#34;] # ä¸éœ€è¦å‘é‚®ä»¶é€šçŸ¥å°±è¿™æ ·è®¾ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>banaction = &lt;span style="color:#666;font-style:italic">iptables-multiport # ç¦ç”¨æ–¹å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>logpath = &lt;span style="color:#666;font-style:italic">/var/log/auth.log # SSH ç™»é™†æ—¥å¿—ä½ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›´æ¥å¤åˆ¶ç‰ˆæœ¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>[sshd]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">ignoreip&lt;/span> = 127.0.0.1/8
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">enabled&lt;/span> = &lt;span style="font-weight:bold;font-style:italic">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">filter&lt;/span> = sshd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">port&lt;/span> = 20253
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">maxretry&lt;/span> = 5 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">findtime&lt;/span> = 300 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">bantime&lt;/span> = 600
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">action&lt;/span> = %(action_)s[&lt;span style="color:#666;font-weight:bold;font-style:italic">port&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;%(port)s&amp;#34;&lt;/span>, &lt;span style="color:#666;font-weight:bold;font-style:italic">protocol&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;%(protocol)s&amp;#34;&lt;/span>, &lt;span style="color:#666;font-weight:bold;font-style:italic">logpath&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;%(logpath)s&amp;#34;&lt;/span>, &lt;span style="color:#666;font-weight:bold;font-style:italic">chain&lt;/span>=&lt;span style="color:#666;font-style:italic">&amp;#34;%(chain)s&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">banaction&lt;/span> = iptables-multiport
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#666;font-weight:bold;font-style:italic">logpath&lt;/span> = /var/log/auth.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è®¾ç½®fail2banå¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl &lt;span style="font-weight:bold;font-style:italic">enable&lt;/span> fail2ban
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="ä½¿ç”¨å¯†é’¥ç™»å½•">
 ä½¿ç”¨å¯†é’¥ç™»å½•
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8%e5%af%86%e9%92%a5%e7%99%bb%e5%bd%95">#&lt;/a>
&lt;/h3>
&lt;blockquote>
&lt;p>å¦‚æœ VPS å‚å•†æä¾›äº† SSH å¯†é’¥ç»‘å®šåŠŸèƒ½ï¼Œå¯ä»¥å¿½ç•¥æœ¬èŠ‚å†…å®¹å¹¶æŒ‰ç…§ VPS å‚å•†æä¾›çš„æ–¹æ³•ç»‘å®šã€‚&lt;/p>&lt;/blockquote>
&lt;p>åœ¨æœ¬åœ° powershell ä¸­è¿è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ssh-keygen -t ed25519
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ssh-keygen -t rsa -b 4096
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>äºŒè€…åŠ å¯†ç®—æ³•ä¸åŒ:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>-b 4096&lt;/code>Â æŒ‡å®šç”Ÿæˆçš„ RSA å¯†é’¥çš„é•¿åº¦ä¸º 4096 ä½&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ed25519 çš„å¯†é’¥é•¿åº¦å›ºå®šï¼Œçº¦ä¸º 256 ä½ï¼Œæ— éœ€æŒ‡å®šå¯†é’¥é•¿åº¦ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ç›´æ¥ä½¿ç”¨é»˜è®¤çš„å¯†é’¥è·¯å¾„å³å¯ã€‚å¯†ç å¯ä»¥ç•™ç©ºï¼Œä¹Ÿå¯ä»¥è®¾ç½®ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>Generating &lt;span style="font-weight:bold;text-decoration:underline">public&lt;/span>/&lt;span style="font-weight:bold;text-decoration:underline">private&lt;/span> ed25519 key pair.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter file in which to save the key (C:\Users\&amp;lt;user&amp;gt;/.ssh/id_ed25519): &lt;span style="color:#888;font-style:italic"># ç›´æ¥å›è½¦
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">&lt;/span>Enter passphrase (&lt;span style="font-weight:bold;text-decoration:underline">empty&lt;/span> &lt;span style="font-weight:bold;text-decoration:underline">for&lt;/span> no passphrase): &lt;span style="color:#888;font-style:italic"># å¯ä»¥ç•™ç©ºï¼Œä¹Ÿå¯ä»¥è®¾ç½®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">&lt;/span>Enter same passphrase again: &lt;span style="color:#888;font-style:italic"># å’Œä¸Šä¸€ä¸ªä¸€æ ·
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åæˆ‘ä»¬åœ¨ VPS ä¸Šç¼–è¾‘ SSH æˆæƒå¯†é’¥æ–‡ä»¶ï¼Œæ³¨æ„éœ€è¦åœ¨rootç”¨æˆ·å’Œérootç”¨æˆ·ä¸‹éƒ½éœ€è¦æ·»åŠ ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim ~/.ssh/authorized_keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>å¦‚æœç›®æ ‡ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹è¿˜æ²¡æœ‰ &lt;code>.ssh&lt;/code> ç›®å½•ï¼Œ ç¡®ä¿ç›®å½•çš„æƒé™æ˜¯ &lt;code>700&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mkdir -p ~/.ssh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod 700 ~/.ssh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»º&lt;code>authorized_keys&lt;/code>æ–‡ä»¶å¹¶èµ‹äºˆç›¸åº”æƒé™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>touch ~/.ssh/authorized_keys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod 600 ~/.ssh/authorized_keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹åæ‰“å¼€ &lt;code>C:\\\Users&amp;lt;user\&amp;gt;/.ssh/id\_ed25519.pub&lt;/code>ï¼Œå¤åˆ¶å…¶å†…å®¹å¹¶ç²˜è´´è¿‡å»ã€‚&lt;/p>
&lt;hr>
&lt;p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç¼–è¾‘ SSH é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>PubkeyAuthentication yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>AuthorizedKeysFile .ssh/authorized_keys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PasswordAuthentication no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœå‘ç°æ²¡æœ‰ç”Ÿæ•ˆï¼š
æ£€æŸ¥ &lt;code>/etc/ssh/sshd_config.d&lt;/code>ä¸‹çš„æ–‡ä»¶&lt;/p>
&lt;p>ä¹‹åé‡å¯ SSH æœåŠ¡ç”Ÿæ•ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl restart ssh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 class="heading" id="å¯ç”¨-ufw-é˜²ç«å¢™">
 å¯ç”¨ UFW é˜²ç«å¢™
 &lt;a class="anchor" href="#%e5%90%af%e7%94%a8-ufw-%e9%98%b2%e7%81%ab%e5%a2%99">#&lt;/a>
&lt;/h3>
&lt;blockquote>
&lt;p>å¦‚æœ VPS å‚å•†æä¾›äº†é˜²ç«å¢™åŠŸèƒ½ï¼Œä¸”æ²¡æœ‰å¤æ‚çš„éœ€æ±‚ï¼Œå¯ä»¥å¿½ç•¥æœ¬èŠ‚å†…å®¹å¹¶ä½¿ç”¨ VPS å‚å•†æä¾›çš„é˜²ç«å¢™ã€‚&lt;/p>&lt;/blockquote>
&lt;p>åœ¨æ­£å¼å¯ç”¨ UFW ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¾ç½®è§„åˆ™ã€‚æˆ‘ä»¬é¦–å…ˆæ¥è®¾ç½® UFW çš„é»˜è®¤è¡Œä¸ºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ufw default allow outgoing &lt;span style="color:#888;font-style:italic"># é»˜è®¤å…è®¸æ‰€æœ‰æ•°æ®å‡ºç«™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw default deny incoming &lt;span style="color:#888;font-style:italic"># é»˜è®¤ç¦æ­¢æ‰€æœ‰æ•°æ®å…¥ç«™&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ UFW å½“å‰ç”Ÿæ•ˆçš„è§„åˆ™ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ufw status
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw status numbered &lt;span style="color:#888;font-style:italic"># åŠ ä¸Šæ•°å­—ç¼–å·&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å…è®¸æˆ–æ‹’ç»æŸç«¯å£çš„ä¼ å…¥ / ä¼ å‡ºæµé‡ï¼ˆéƒ¨åˆ†ä»¥ 22ã€80ã€443 ç«¯å£ä¸ºä¾‹ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸22ç«¯å£çš„protoåè®®çš„æµé‡å…¥ç«™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow in 22/proto
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic">#å…è®¸22ç«¯å£çš„protoåè®®çš„æµé‡å‡ºç«™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow out 22/proto
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># åœ¨æœªæŒ‡å®šin/outçš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¸ºin&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow 22/proto
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># åœ¨æœªæŒ‡å®šprotoçš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¸ºtcpå’Œudp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow 22
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># æ‹’ç»çš„è¯å°±æŠŠallowæ”¹æˆdeny&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw deny 22
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸ä»start_portåˆ°end_portçš„ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow start_port:end_port
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸å¤æ•°ä¸ªç«¯å£ï¼Œä»¥è‹±æ–‡é€—å·åˆ†éš”&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow port1,port2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸æ¥è‡ªäºç‰¹å®šipæˆ–cidræ®µçš„æµé‡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow from ip/cidr
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸æ¥è‡ªäºç‰¹å®šipæˆ–cidræ®µç«¯å£22çš„æµé‡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow from ip/cidr to any port 22
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å…è®¸æ¥è‡ªäºç‰¹å®šipæˆ–cidræ®µç«¯å£22çš„tcpåè®®çš„æµé‡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow from ip/cidr to any proto tcp port 22
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># å¦‚æœæŒ‡å®šå¤æ•°ä¸ªç«¯å£ï¼Œåˆ™å¿…é¡»æŒ‡å®šåè®®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow from ip to any proto tcp port 80,443
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#888;font-style:italic"># commentç”¨äºæ³¨é‡Š&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw allow from ip to any proto tcp port 80,443 comment &lt;span style="color:#666;font-style:italic">&amp;#34;hello&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ é™¤ç”Ÿæ•ˆçš„è§„åˆ™ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ufw delete allow 22 &lt;span style="color:#888;font-style:italic"># åœ¨è§„åˆ™å‰é¢åŠ ä¸ªdelete&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo ufw delete 1 &lt;span style="color:#888;font-style:italic"># æŒ‰ç…§numberedçš„ç¼–å·åˆ é™¤ä¹Ÿè¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨ç¡®å®šæ‰€æœ‰è§„åˆ™å‡æˆåŠŸè®¾ç½®åï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ \ å…³é—­ \ é‡å¯ UFW&lt;/p>
&lt;blockquote>
&lt;p>å¯åŠ¨é˜²ç«å¢™å‰åŠ¡å¿…ä¿è¯ 22 ç«¯å£ï¼ˆæˆ–è€…å…¶ä»– SSH ç«¯å£ï¼‰è¢«æ”¾è¡Œã€‚&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ufw enable|disable|reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœéœ€è¦é‡ç½®è§„åˆ™ï¼Œè¯·ä½¿ç”¨ï¼š&lt;/p>
&lt;blockquote>
&lt;p>é‡ç½®è§„åˆ™å‰åŠ¡å¿…ä¿è¯ UFW å¤„äºå…³é—­çŠ¶æ€ã€‚&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ufw reset
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ¬äººå»ºè®®ä»…æ”¾è¡Œæ­£åœ¨ä½¿ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚ 22ã€80ã€443ã€‚&lt;/p>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒUFW ä»…è®°å½•ä¸ç¬¦åˆè§„åˆ™çš„è¢«æ‹’ç»çš„æ•°æ®åŒ…ã€‚å¦‚æœéœ€è¦è®°å½•ä¸è¯¥æœåŠ¡ç›¸å…³çš„æ¯ä¸ªè¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥åœ¨ allow ååŠ ä¸Š log ä»¥è¿›è¡Œè®°å½•ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code># æˆåŠŸè¿æ¥ ssh çš„ä¹Ÿè®°ä¸€ä¸‹æ—¥å¿—å¤‡æŸ¥æ¯”è¾ƒå¥½ ufw allow log 22/tcp
&lt;/code>&lt;/pre>&lt;h2 class="heading" id="æ›´æ”¹æ—¶åŒº">
 æ›´æ”¹æ—¶åŒº
 &lt;a class="anchor" href="#%e6%9b%b4%e6%94%b9%e6%97%b6%e5%8c%ba">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo timedatectl set-timezone Asia/Shanghai
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 class="heading" id="ä¿è¯è½¯ä»¶æ›´æ–°">
 ä¿è¯è½¯ä»¶æ›´æ–°
 &lt;a class="anchor" href="#%e4%bf%9d%e8%af%81%e8%bd%af%e4%bb%b6%e6%9b%b4%e6%96%b0">#&lt;/a>
&lt;/h2>
&lt;h3 class="heading" id="æ—¥å¸¸æ›´æ–°ç³»ç»Ÿ">
 æ—¥å¸¸æ›´æ–°ç³»ç»Ÿ
 &lt;a class="anchor" href="#%e6%97%a5%e5%b8%b8%e6%9b%b4%e6%96%b0%e7%b3%bb%e7%bb%9f">#&lt;/a>
&lt;/h3>
&lt;p>ä¸ªäººå»ºè®®å®šæœŸç™»å½• VPS è¿è¡Œ &lt;code>sudo apt update &amp;amp;&amp;amp; sudo apt upgrade&lt;/code> æ¥ä¿è¯ VPS å†…æ‰€æœ‰è½¯ä»¶åŒ…å‡ä¸ºæœ€æ–°ã€‚&lt;/p>
&lt;p>ä¸è¿‡ Ubuntu é»˜è®¤ä¼šæ¯å¤©è‡ªåŠ¨å®‰è£…ç³»ç»Ÿçš„å®‰å…¨æ›´æ–°ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªé¢‘ç‡æ²¡å¿…è¦å¤ªå‹¤ã€‚&lt;/p></description></item></channel></rss>