<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=https://blog.yzyy.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.yzyy.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.yzyy.de/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://blog.yzyy.de/android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://blog.yzyy.de/apple-touch-icon.png><meta name=description content="从零搭建免费图床系统，详细覆盖 Cloudflare R2、WebP Cloud 及 PicList 的配置与优化，适用于个人笔记与博客图片管理。"><title>图床搭建(Cloudflare R2 + WebP Cloud + PicList) | G-Hung的博客</title><link rel=canonical href=https://blog.yzyy.de/explore/%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA/><meta property="og:url" content="https://blog.yzyy.de/explore/%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA/"><meta property="og:site_name" content="G-Hung的博客"><meta property="og:title" content="图床搭建(Cloudflare R2 + WebP Cloud + PicList)"><meta property="og:description" content="从零搭建免费图床系统，详细覆盖 Cloudflare R2、WebP Cloud 及 PicList 的配置与优化，适用于个人笔记与博客图片管理。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="explore"><meta property="article:published_time" content="2024-02-29T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-29T00:00:00+00:00"><meta property="article:tag" content="探索"><meta property="article:tag" content="图床"><link rel=stylesheet href=/assets/combined.min.5e139504908908255829461aa5380534c88b0d4f739385601750a2a381626824.css media=all><script async src="https://www.googletagmanager.com/gtag/js?id=G-88BLW4V0HZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-88BLW4V0HZ")}</script></head><body class=auto><div class=content><header><div class=header><h1 class=header-title><a href=https://blog.yzyy.de/>G-Hung的博客</a></h1><div class=header-menu><p class=small><a href=/>/home</a></p><p class=small><a href=/post>/日常</a></p><p class=small><a href=/explore>/探索记录</a></p><p class=small><a href=/tags>/tags</a></p></div></div></header><main class=main><div class=breadcrumbs><a href=/>Home</a><span class=breadcrumbs-separator>/</span><a href=/explore/>Explores</a><span class=breadcrumbs-separator>/</span>
<a href=/explore/%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA/>图床搭建(Cloudflare R2 + WebP Cloud + PicList)</a></div><div class=autonumber><article><header class=single-intro-container><h1 class=single-title>图床搭建(Cloudflare R2 + WebP Cloud + PicList)</h1><p class=single-summary>Cloudflare R2 + WebP Cloud + PicList 免费图床搭建全流程</p><div class=single-subsummary><img src=/avatar.jpg alt="Author Avatar"><div><p class=author>ghung</p><p class=single-date><time datetime=2024-02-29T00:00:00+00:00>2024 Feb 29</time>
&nbsp; · &nbsp;2 min read</p></div></div></header><div class=single-tags><span><a href=https://blog.yzyy.de/tags/%E6%8E%A2%E7%B4%A2/>#探索</a>
</span><span><a href=https://blog.yzyy.de/tags/%E5%9B%BE%E5%BA%8A/>#图床</a></span></div><aside class=toc><p><strong>Table of contents</strong></p><nav id=TableOfContents><ul><li><a href=#前言>前言</a><ul><li><a href=#cloudflare-r2--webp-cloud--picgo>Cloudflare R2 + WebP Cloud + PicGo</a></li></ul></li><li><a href=#图床搭建说明>图床搭建说明</a><ul><li><a href=#cloudflare-r2>Cloudflare R2</a></li><li><a href=#picgo-piclist>PicGo->PicList</a></li><li><a href=#webp-cloud-图片优化>WebP Cloud 图片优化</a></li></ul></li><li><a href=#备用方案>备用方案</a></li><li><a href=#与obsidian集成>与Obsidian集成</a></li></ul></nav></aside><div class=single-content><h2 class=heading id=前言>前言
<a class=anchor href=#%e5%89%8d%e8%a8%80>#</a></h2><p>本篇基于<a href=https://www.pseudoyu.com/zh/2024/06/30/free_image_hosting_system_using_r2_webp_cloud_and_picgo/>从零开始搭建你的免费图床系统（Cloudflare R2 + WebP Cloud + PicGo） · Pseudoyu</a>教程书写，根据自己的习惯以及相关工具的迭代更新所书写。</p><p>本篇是关于图床系统的解决方案。</p><p>有搭建图床的念头是因为通过Web插件经常clip精品文章，在这些文章中有大量外链图片，或许哪一天挂了就会出问题。最近又部署了个人博客，搭建一个图床系统迫在眉睫。</p><h3 class=heading id=cloudflare-r2--webp-cloud--picgo>Cloudflare R2 + WebP Cloud + PicGo
<a class=anchor href=#cloudflare-r2--webp-cloud--picgo>#</a></h3><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716103644466.png></div></figure></p><p>早就听过Cloudflare的R2对象存储服务，还有B2（Backblaze）什么的。</p><p>赛博菩萨 Cloudflare 提供的 R2 对象存储这一服务，免费计划中有每月 10 GB 的存储容量，对于个人使用来说完全够用，大厂的服务与数据安全也有保障。</p><p>为了优化用户的访问，又使用了一个「<a href=https://webp.se/>WebP Cloud</a>」服务对 R2 的图片进行代理，在代理层面进一步减小图片体积，虽然对于国内用户来说速度肯定还是比不上阿里云 OSS 这种线路，但是在不用备案、稳定且免费的综合条件下，这是我能想到的最好的方案了。</p><p>在电脑端同样是通过 PicGo 客户端几乎一键上传并生成博客直接可用的 markdown 图片链接，配置完成后使用起来很顺滑。</p><h2 class=heading id=图床搭建说明>图床搭建说明
<a class=anchor href=#%e5%9b%be%e5%ba%8a%e6%90%ad%e5%bb%ba%e8%af%b4%e6%98%8e>#</a></h2><p>Cloudflare R2 + WebP Cloud + PicGo 的方案尽管牵扯到了多个组件和平台，但所有操作都在 Free Plan 中，也是我最终选定的方案，下面将从零开始介绍如何搭建这个免费图床系统。</p><h3 class=heading id=cloudflare-r2>Cloudflare R2
<a class=anchor href=#cloudflare-r2>#</a></h3><p>R2 是 Cloudflare 推出的免费对象存储服务，需要免费注册一个 <a href=https://www.cloudflare.com/zh-cn/>Cloudflare 账号</a>才能使用，注册登录后，点击左侧边栏的 R2 访问服务，但需要注意的是开通 R2 服务需要绑定信用卡（国内外主流信用卡皆可），但并不会扣费，主要是为了验证用户身份使用。</p><h4 class=heading id=创建图床-bucket>创建图床 Bucket
<a class=anchor href=#%e5%88%9b%e5%bb%ba%e5%9b%be%e5%ba%8a-bucket>#</a></h4><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716103957488.png></div></figure></p><p>开通 R2 服务后，点击右上角「创建存储桶」按钮进行创建。</p><p>进入创建配置界面后，需要填写存储桶（Bucket）名称，建议有一些辨识度，后续在配置上传时会用到。</p><p>位置则选择「自动」，但可以额外多配置一个位置提示，由于我后续还将使用「<a href=https://webp.se/>WebP Cloud</a>」服务的美西机房进行图片代理优化，所以在此处选择的是「北美洲西部（WNAM）」，根据需求选其他区域也可以，但 Cloudflare 并不保证一定会分配到所指定的区域。</p><p>点击「创建存储桶」按钮即完成创建，此时我们已经可以向我们的存储桶上传文件了，可以选择在网页直接上传文件或文件夹。</p><p>也可以使用 S3 API 进行上传，我们后续使用 PicGo 客户端进行上传就依赖这种方式，但需要进行一些额外配置，点击导航栏「设置」选项进行配置。</p><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716104739846.png></div></figure></p><p>首先我们需要打开「R2.dev 子域」，这是为了后续访问图片时需要的公网地址，点击「允许访问」，并按照提示输入「allow」即可开启。<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716104806788.png></div></figure></p><p>完成后会显示一个以 <code>r2.dev</code> 结尾的公网网址，即我们后续访问图片的网址。<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716104823644.png></div></figure></p><h4 class=heading id=自定义图床域名可选>自定义图床域名（可选）
<a class=anchor href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%9b%be%e5%ba%8a%e5%9f%9f%e5%90%8d%e5%8f%af%e9%80%89>#</a></h4><p>但是分配的网址比较长，不易于记忆，我们可以通过「自定义域」来绑定我们的专属域名，点击「连接域」按钮。</p><p>输入自己想绑定的域名，点击继续。<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716104920972.png></div></figure></p><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716104954128.png></div></figure></p><p>连接域，并等待 DNS 解析生效即可。</p><p>完成后 bucket 状态处「公共 URL 访问」显示“已允许”，且「域」显示为我们刚自定义的域名即配置成功。</p><h4 class=heading id=配置-bucket-访问-api>配置 Bucket 访问 API
<a class=anchor href=#%e9%85%8d%e7%bd%ae-bucket-%e8%ae%bf%e9%97%ae-api>#</a></h4><p>每次都要打开 Cloudflare 页面手动上传图片的方式显然不够便捷。R2 提供了 S3 兼容的 API，可以方便地使用一些客户端/命令行工具进行上传、删除等操作。</p><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716105046500.png></div></figure></p><p>回到 R2 主页面，点击右上角「管理 R2 API 令牌」，进入后点击「创建 API 令牌」。<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716105230904.png></div></figure></p><p>输入令牌名称，「权限」选择“对象读和写”并将此 API 指定之前所创建的 Bucket，这样最小化权限也保障数据安全，其余选项保持默认即可。</p><p>完成创建后会显示所有密钥，我们使用 PicGo 需要的是下面三个信息，不过因为只会显示一次，建议在密码管理软件或其他地方妥善保管好这些参数信息。<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716105529633.png></div></figure></p><p>至此，我们需要在 Cloudflare R2 上配置的部分就完成了，接下来我们需要配置 PicGo 客户端。</p><h3 class=heading id=picgo-piclist>PicGo->PicList
<a class=anchor href=#picgo-piclist>#</a></h3><p>PicGo 是一个用于快速上传并获取图片 URL 的工具软件，有着较为丰富的插件生态，支持多种图床服务，其 GitHub 仓库为「<a href=https://github.com/Molunerfinn/PicGo>GitHub - Molunerfinn/PicGo</a>」，可以下载对应平台客户端使用。</p><p>我的主要需求是配合Obsidian使用，在配置Obsidian的「Image auto upload」插件时，发现了PicGo的二开项目：</p><p><a href=https://github.com/Kuingsmile/PicList>GitHub - Kuingsmile/PicList</a></p><p>相较于PicGo：</p><ul><li>支持第二图床同步上传</li><li>支持通过API实现云端删除</li><li>内置图床额外添加了WebDav、本地图床和SFTP等</li></ul><p>具体请自行查看<a href=https://github.com/Kuingsmile/PicList/blob/dev/README_cn.md#%E7%89%B9%E8%89%B2%E5%8A%9F%E8%83%BD>PicList特色功能</a></p><h4 class=heading id=配置-r2-图床>配置 R2 图床
<a class=anchor href=#%e9%85%8d%e7%bd%ae-r2-%e5%9b%be%e5%ba%8a>#</a></h4><p>PicGo 本体并不包括 S3 图床，但可以通过「<a href=https://github.com/wayjam/picgo-plugin-s3>GitHub - wayjam/picgo-plugin-s3</a>」插件来支持。</p><p>如果出现安装转圈，可以尝试手动安装：</p><ul><li>在<code>C:\Users\user\AppData\Roaming\picgo</code>打开终端。</li><li>运行<code>npm install picgo-plugin-s3</code>,观察是否有报错，等待完成后重启picgo即可发现在多了一个Amazon S3的图床设置。</li></ul><p>出现问题的原因：</p><ul><li>安装过程中出现了报错，很有可能是nodejs版本过低的原因。<figure><div class=img-container><img loading=lazy alt=node版本要求 src=https://webp.050612.xyz/2025/02/20250205232413441.png></div></figure></li></ul><p>在「插件设置」中选择安装，「图床设置」中就新增了 Amazon S3 选项。点击进入配置选项。</p><ul><li>PicList<figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716105923081.png></div></figure></li></ul><p>这里有几项配置需要尤其注意。</p><ul><li><strong>应用密钥 ID</strong>，填写 R2 API 中的 Access Key ID（访问密钥 ID）</li><li><strong>应用密钥</strong>，填写 R2 API 中的 Secret Access Key（机密访问密钥）</li><li><strong>桶名</strong>，填写 R2 中创建的 Bucket 名称</li><li><strong>文件路径</strong>，上传到 R2 中的文件路径，我选择使用 <code>{year}/{month}/{fullName}</code> 来初步分文件夹并保留原文件的文件名和扩展名。</li><li><strong>自定义节点</strong>，填写 R2 API 中的「为 S3 客户端使用管辖权地特定的终结点」，即 <code>xxx.r2.cloudflarestorage.com</code> 格式的 S3 Endpoint</li><li><strong>自定义输出URL模板</strong>，如果在创建R2时使用了自定义域，需要修改此项，并且注意要和&lt;文件路径>一项对应，先上传一张图片，去cf查看图片链接，获得生成逻辑再进行相应填写。</li></ul><p>占位符详情请查看：</p><p><a href=https://github.com/wayjam/picgo-plugin-s3>GitHub - wayjam/picgo-plugin-s3: PicGo S3 插件</a></p><p>其他配置保持默认即可，确认参数无误后点击「确定」与「设置为默认图床」即可。</p><h4 class=heading id=图片上传>图片上传
<a class=anchor href=#%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0>#</a></h4><p><figure><div class=img-container><img loading=lazy alt=20250716110818243 src=https://webp.050612.xyz/2025/07/20250716110818243.png></div></figure></p><p>完成上述配置后，我们就可以在「上传区」直接拖入文件进行图片上传了，如上传后显示无误则为配置成功，生成的链接会自动在系统剪贴板中，直接在需要的地方粘贴即可。</p><p><figure><div class=img-container><img loading=lazy alt=20250716110939261 src=https://webp.050612.xyz/2025/07/20250716110939261.png></div></figure></p><p>并且可以在链接格式处选择对应格式，如 URL 或是博客可用的 Markdown 格式链接等。这里我还做了一个小的配置，在左侧「PicGo 设置」 - 「自定义链接格式」中修改为 <code>![$fileName]($url)</code>，并在上传区的链接格式处选择了「Custom」，这样我上传后就会根据文件名生成以文件名为 Alt 文本的 Markdown 图片链接。</p><h3 class=heading id=webp-cloud-图片优化>WebP Cloud 图片优化
<a class=anchor href=#webp-cloud-%e5%9b%be%e7%89%87%e4%bc%98%e5%8c%96>#</a></h3><p>至此我们已经完成了整个图床的搭建、配置和上传，但通常我们本地截图或是相机拍摄的图片体积较大，对于访客来说加载时间会较长，并不直接适合互联网发布。</p><p>这次更换图床方案后也开始寻找更智能的图片优化服务，想到了「<a href=https://webp.se/>WebP Cloud</a>」。
打开了官网「<a href=https://webp.se/>webp.se</a>」看了一下更为详细的介绍。</p><p>简单来说这是一个类 CDN 的图片代理 SaaS 服务，可以在几乎不改变画质的情况下大幅缩小图片体积，加快整体站点加载速度。发展到现在除了图片体积减少外，还提供了缓存、添加水印、图片滤镜等更多实用的功能，并提供了自定义 Header 等配置选项。</p><p>看了一圈，觉得能很好满足我的博客图片优化需求，开始折腾配置。</p><h4 class=heading id=配置-webp-cloud>配置 WebP Cloud
<a class=anchor href=#%e9%85%8d%e7%bd%ae-webp-cloud>#</a></h4><p>首先通过 GitHub 授权登录 <a href=https://dashboard.webp.se/>WebP Cloud</a> 平台。</p><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716111504411.png></div></figure></p><p>页面非常直观，主要显示了当前 Plan 下的 Free Quota 和额外 Quota 的数据，以及一些用量统计。</p><p>点击「Create Proxy」按钮可以添加配置。</p><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716111814390.png></div></figure></p><ul><li>为了优化国内访问，我「Proxy Region」选择的是美西「Hillsboro, OR」区域</li><li>「Proxy Name」填写一个自定义名称即可</li><li>「Proxy Origin URL」，比较重要，需要填写上文我们配置好的 R2 自定义域名，如我填写的是 <code>image.yzyy.de</code>，如果没配置自定义域名则填写 R2 提供的 <code>xxx.r2.dev</code> 格式的域名</li></ul><p><figure><div class=img-container><img loading=lazy alt src=https://webp.050612.xyz/2025/07/20250716112113344.png></div></figure></p><p>图中 Basic info 部分「Visitor」下显示的以 <code>xxx.webp.li</code> 格式即为我们的代理地址。</p><h5 class=heading id=自定义域名>自定义域名
<a class=anchor href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%9f%9f%e5%90%8d>#</a></h5><p>支持了自定义配置域名，详细教程可参考「<a href=https://docs.webp.se/webp-cloud/custom-domain/>Custom Domain | WebP Cloud Services Docs</a>」。</p><p><figure><div class=img-container><img loading=lazy alt=添加域名解析 src=https://webp.050612.xyz/2025/02/Pasted%20image%2020250206175133.png></div></figure></p><h4 class=heading id=更改-picgo-配置>更改 PicGo 配置
<a class=anchor href=#%e6%9b%b4%e6%94%b9-picgo-%e9%85%8d%e7%bd%ae>#</a></h4><p><figure><div class=img-container><img loading=lazy alt=change_pic_go_config src=https://webp.050612.xyz/2025/02/change_pic_go_config.png></div></figure></p><p>需要注意的是，由于我们最终需要放在博客中的图片是经过 WebP Cloud 代理过的链接，所以需要回到 PicGo 的「图床设置」中，将「自定义域名」改为我们刚配置的 WebP Cloud 代理地址，即格式为 <code>xxx.webp.li</code> 的代理链接或其他自定义域名。</p><h4 class=heading id=webp-cloud-用量>WebP Cloud 用量
<a class=anchor href=#webp-cloud-%e7%94%a8%e9%87%8f>#</a></h4><p>免费用户每天有 2000 Free Quota，即能够代理 2000 次图片访问请求，并提供 100M 的图片缓存，对于一般用户来说完全够用，如有一些流量较大的特定时期也可以购买额外 Quota，价格很便宜。</p><p>如超过了 Quota，访问则会被 301 转发到源站图片地址，不经 WebP Cloud 服务压缩，但依然可用；超过 100M 的缓存则会按照 LRU 算法清理，所以依然能够保障一些高频请求的图片能够有较好的访问体验。</p><h2 class=heading id=备用方案>备用方案
<a class=anchor href=#%e5%a4%87%e7%94%a8%e6%96%b9%e6%a1%88>#</a></h2><ol><li>tg方案</li></ol><p><a href=https://github.com/x-dr/telegraph-Image>GitHub - x-dr/telegraph-Image</a></p><h2 class=heading id=与obsidian集成>与Obsidian集成
<a class=anchor href=#%e4%b8%8eobsidian%e9%9b%86%e6%88%90>#</a></h2><p>如果使用的是 <a href=https://obsidian.md/>obsidian</a> 进行博客写作，推荐将 Picgo 与 obsidian <a href=https://github.com/renmu123/obsidian-image-auto-upload-plugin>Image Auto Upload Plugin</a> 插件结合使用，这样可以一键上传文章中所有图片。</p></div></article><div class=single-comments><script src=https://giscus.app/client.js data-repo=eaiu/eaiu.github.io data-repo-id=R_kgDOPMv-Yw data-category data-category-id=DIC_kwDOPMv-Y84CtAeO data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></div><div class=single-pagination><hr><div class=flexnowrap><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/explore/kiro-ide-%E5%88%9D%E4%BD%93%E9%AA%8C/>Log-Structured Merge Tree</a></div></div></div><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text><a href=/explore/%E6%9C%8D%E5%8A%A1%E5%99%A8/vps%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD/>VPS基础安全配置实践指南</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>All content licensed under <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a> unless otherwise stated. Copyright © 2025 ghung<br>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://github.com/tomfran/typo>tomfran/typo</a></p></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></body><script src=/js/theme-switch.js></script><script defer src=/js/copy-code.js></script></html>